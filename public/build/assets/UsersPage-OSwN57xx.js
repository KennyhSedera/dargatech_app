import{r as o,j as t,L as F}from"./app-BIIzlTCs.js";import{A as E}from"./AuthenticatedLayout-RPk7-7TQ.js";import{g as D,d as P}from"./userService-g1Ze1Yx2.js";import{n as _,s as H,y as I,F as M,u as z,t as R}from"./constant-DzZRzbya.js";import{H as T}from"./HeaderPage-CQXIi_rm.js";import{S as V}from"./Snackbar-D6o1nh_8.js";import{C as $}from"./ConfirmDialog-DRmhmXlU.js";import"./transition-Cbgflb7M.js";import"./index-5tr5pGGr.js";import"./iconBase-Dxfvu3rN.js";import"./useTheme-s-3zzg23.js";import"./index-CaupsslJ.js";import"./api-BStzSCx7.js";import"./Modal-CLsMs9kv.js";const ae=()=>{const[w,u]=o.useState([]),[N,b]=o.useState([]),[C,L]=o.useState(!0),[v,k]=o.useState(""),[r,f]=o.useState({open:!1,message:"",btnAcceptName:"",title:"",btnAcceptColor:""}),[i,j]=o.useState({open:!1,message:"",type:"success"});o.useEffect(()=>{(async()=>{try{const a=await D();u(a),b(a)}catch(a){console.error("Failed to fetch users:",a)}finally{L(!1)}})()},[]);const S=e=>{k(e);const a=w.filter(s=>{var l,c,n,d,m,p,x,h,g;return s.name.toLowerCase().includes(e.toLowerCase())||s.email.toLowerCase().includes(e.toLowerCase())||((l=s.technicien)==null?void 0:l.contact.toLowerCase().includes(e.toLowerCase()))||((c=s.technicien)==null?void 0:c.adress.toLowerCase().includes(e.toLowerCase()))||s.user_role.name.toLowerCase().includes(e.toLowerCase())||((n=s.profile)==null?void 0:n.adress.toLowerCase().includes(e.toLowerCase()))||((d=s.profile)==null?void 0:d.contact.toLowerCase().includes(e.toLowerCase()))||((m=s.partenaire)==null?void 0:m.name.toLowerCase().includes(e.toLowerCase()))||((p=s.partenaire)==null?void 0:p.email.toLowerCase().includes(e.toLowerCase()))||((x=s.partenaire)==null?void 0:x.telephone.toLowerCase().includes(e.toLowerCase()))||((h=s.partenaire)==null?void 0:h.adress.toLowerCase().includes(e.toLowerCase()))||((g=s.partenaire)==null?void 0:g.site_web.toLowerCase().includes(e.toLowerCase()))});b(a)},A=e=>{e.target.onerror=null,e.target.src="/path/to/default-avatar.png"},U=e=>{f({open:!0,message:"Voulez-vous vraiment supprimer cet utilisateur ?",btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>f({...r,open:!1}),accept:()=>P(e).then(a=>{a.success?(j({...i,open:!0,message:"Utilisateur supprimé avec succès",type:"success"}),f({...r,open:!1})):j({...i,open:!0,message:a.message,type:"error"})})})};return t.jsxs(E,{children:[t.jsx(F,{title:"Users"}),t.jsx(T,{title:"Liste des utilisateurs",onSearch:S,search:v,btn:!1}),t.jsx($,{open:r.open,message:r.message,btnAcceptName:r.btnAcceptName,title:r.title,btnAcceptColor:r.btnAcceptColor,close:r.close,accept:r.accept}),t.jsx(V,{open:i.open,message:i.message,type:i.type,onClose:()=>j({...i,open:!1})}),t.jsx("div",{className:"py-8",children:t.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:C?t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):w.length===0?t.jsx("div",{className:"flex justify-center",children:t.jsx("img",{src:_,alt:"no data",className:"max-w-md mt-2 opacity-50"})}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:N.map(e=>{var a,s,l,c,n,d,m,p,x,h,g,y;return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 dark:from-indigo-600 dark:via-purple-600 dark:to-blue-700 opacity-90"}),t.jsxs("div",{className:"relative pt-4 pb-14 px-6 flex justify-between items-start",children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:e.name}),t.jsx("div",{className:"relative",children:t.jsx("button",{onClick:()=>U(e.id),className:"p-2 text-white hover:bg-red-50 dark:hover:bg-gray-700 rounded-full transition-colors",children:t.jsx(H,{})})})]}),t.jsx("div",{className:"absolute -bottom-12 left-6",children:t.jsx("div",{className:"h-24 w-24 rounded-xl shadow-md overflow-hidden border-4 border-white dark:border-gray-800",children:(a=e.profile)!=null&&a.photo||(s=e.technicien)!=null&&s.photo||(l=e.partenaire)!=null&&l.logo?t.jsx("img",{src:((c=e.profile)==null?void 0:c.photo)||((n=e.technicien)==null?void 0:n.photo)||((d=e.partenaire)==null?void 0:d.logo),alt:`${e.name}'s profile`,className:"h-full w-full object-cover bg-gray-100 dark:bg-gray-900",onError:A}):t.jsx("div",{className:"h-full w-full bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-700 dark:to-gray-600 flex items-center justify-center",children:t.jsx(I,{className:"text-4xl text-gray-400 dark:text-gray-300"})})})})]}),t.jsxs("div",{className:"pt-14 px-6 pb-6",children:[t.jsx("div",{className:"mt-2 mb-4",children:t.jsx("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-gradient-to-r from-green-400 to-blue-500 text-white",children:e.user_role.name})}),t.jsxs("div",{className:"space-y-3 mt-4",children:[t.jsxs("div",{className:"flex items-center text-sm",children:[t.jsx(M,{className:"text-gray-500 dark:text-gray-400 mr-2"}),t.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:e.email})]}),t.jsxs("div",{className:"flex items-center text-sm",children:[t.jsx(z,{className:"text-gray-500 dark:text-gray-400 mr-2"}),t.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((m=e.technicien)==null?void 0:m.contact)||((p=e.profile)==null?void 0:p.contact)||((x=e.partenaire)==null?void 0:x.telephone)})]}),t.jsxs("div",{className:"flex items-center text-sm",children:[t.jsx(R,{className:"text-gray-500 dark:text-gray-400 mr-2"}),t.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((h=e.technicien)==null?void 0:h.adress)||((g=e.profile)==null?void 0:g.adress)||((y=e.partenaire)==null?void 0:y.adresse)})]})]})]})]},e.id)})})})})]})};export{ae as default};
