import{r as a,j as t,$,m as R}from"./app-4wEmdYjz.js";import{F as A}from"./FormulaireClient-C-sA89xY.js";import{C as M}from"./ConfirmDialog-DGGNK1Fu.js";import{D as G}from"./DataTable-BxOQKrBi.js";import{E as H}from"./EmptyState-DKwUodRG.js";import{H as O}from"./HeaderPage-zfXlmYva.js";import{S as V}from"./Snackbar-_h9jFmnY.js";import{A as W,R as q}from"./AuthenticatedLayout-DCjh82tU.js";import{b as z,d as B}from"./clientService-Bim-z46b.js";import{j as J}from"./constant-B_m1A7JV.js";import{G as K}from"./index-DWXFcxJg.js";import{T as Q,a as U}from"./index-C_Bbq1aG.js";import"./Modal-bs1AMDwt.js";import"./transition-a7jrO0aT.js";import"./TextInput-CO5S_b65.js";import"./createLucideIcon-DJ98PbM6.js";import"./InputLabel-ET58zQnd.js";import"./validateForm-f9K0gDaZ.js";import"./SelectInput-C0OAjYZh.js";import"./index-C3jsDX8T.js";import"./iconBase-jDJ7O41m.js";import"./useTheme-BkwNSV-f.js";import"./api-CHT2VR--.js";const ye=()=>{const[d,g]=a.useState(""),[C,n]=a.useState(!1),[y,l]=a.useState(1),[u,j]=a.useState([]),[x,h]=a.useState([]),[w,b]=a.useState({}),[S,f]=a.useState(!0),[r,c]=a.useState({open:!1,message:"",id:0}),[o,m]=a.useState({open:!1,message:"",type:"success"}),[N,L]=a.useState(10),p=async()=>{f(!0);const i=(await z()).clients.map(s=>({id:s.id,nom:s.nom,prenom:s.prenom,CIN:s.CIN,email:s.email,telephone:s.telephone,localisation:s.localisation,surface_cultivee:s.surface_cultivee,type_activite_agricole:s.type_activite_agricole,created_via:s.created_via,is_payed:s.is_payed}));j(i),h(i),f(!1)};a.useEffect(()=>{p()},[]);const _=e=>{g(e),l(1);const i=u.filter(s=>s.nom.toLowerCase().includes(e.toLowerCase())||s.prenom.toLowerCase().includes(e.toLowerCase())||s.telephone.toLowerCase().includes(e.toLowerCase())||s.surface_cultivee.toLowerCase().includes(e.toLowerCase())||s.type_activite_agricole.toLowerCase().includes(e.toLowerCase())||s.localisation.toLowerCase().includes(e.toLowerCase()));h(i)},v=()=>{n(!0)},k=[{key:"id",label:"ID",sortable:!0,customRender:e=>t.jsx("div",{className:"text-sm",children:t.jsx("span",{children:e})})},{key:"nom",label:"Nom",sortable:!0},{key:"prenom",label:"Prénom",sortable:!0},{key:"CIN",label:"CIN"},{key:"email",label:"Email",sortable:!0},{key:"telephone",label:"Téléphone"},{key:"localisation",label:"Localisation",sortable:!0},{key:"type_activite_agricole",label:"Type d'activité agricole"},{key:"is_payed",label:"Statut",customRender:e=>t.jsx("span",{className:`text-sm font-medium ${e?"text-green-500":"text-red-500"}`,children:e?"Payé":"Non payé"})},{key:"created_via",label:"Via",customRender:e=>t.jsx("span",{className:"text-xl font-medium text-gray-900 dark:text-white",children:e==="web"?t.jsx(U,{}):t.jsx(q,{className:"text-blue-400"})})}],P=[{label:t.jsx(J,{className:"text-base"}),color:"text-green-500",hoverColor:"text-green-600",handler:e=>I(e.id)},{label:t.jsx(Q,{className:"text-lg"}),color:"text-blue-500",hoverColor:"text-blue-600",handler:e=>T(e)},{label:t.jsx(K,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:e=>E(e)}],D=e=>{p(),e&&m({...o,message:e,open:!0}),b({})},T=e=>{b(e),n(!0)},E=e=>{c({open:!0,message:`Êtes-vous sûr de vouloir supprimer ${e.nom} ${e.prenom}?`,id:e.id})},F=async()=>{const{message:e}=await B(r.id);m({...o,message:e,open:!0}),c({...r,open:!1,id:0}),p(),l(1)},I=async e=>{R.visit(`/client/${e}`)};return t.jsxs(W,{children:[t.jsx($,{title:"Maraîchers"}),t.jsx(O,{title:`Liste des Maraîchers ( Total: ${u.length} )`,handleClick:v,onSearch:_,search:d}),t.jsx(A,{setOpen:n,open:C,dataModify:w,onCloseFormulaire:D}),t.jsx(V,{message:o.message,type:o.type,duration:3e3,position:"top-right",show:o.open,onClose:()=>m({...o,message:"",open:!1})}),t.jsx(M,{open:r.open,message:r.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>c({...r,open:!1}),accept:F}),S?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"w-12 h-12 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):t.jsx("div",{children:x.length>0?t.jsx(G,{headers:k,rows:x,itemsPerPage:N,actions:P,className:"mt-4",currentPage:y,onPageChange:l,onItemsPerPageChange:e=>L(e)}):t.jsx(H,{nom:"maraîcher",search:d})})]})};export{ye as default};
