import{r as a,j as s,$,m as R}from"./app-C0R29XIQ.js";import{F as A}from"./FormulaireClient-m4EHOQu3.js";import{C as M}from"./ConfirmDialog-f1tpS5vD.js";import{D as G}from"./DataTable-DjK83WDT.js";import{E as H}from"./EmptyState-OdRGVVF3.js";import{H as O}from"./HeaderPage-DAMjy7Qd.js";import{S as V}from"./Snackbar-BZIn-37I.js";import{A as W,R as q}from"./AuthenticatedLayout-BghdF22p.js";import{b as z,d as B}from"./clientService-C5lm4XBS.js";import{j as J}from"./constant-DIokkB-X.js";import{G as K}from"./index-CpSAhMeT.js";import{T as Q,a as U}from"./index-BdfHga1E.js";import"./Modal-B1XyOMts.js";import"./transition-CbffA-Ro.js";import"./TextInput-FYzGsY1y.js";import"./createLucideIcon-BAjLB3is.js";import"./InputLabel-DSyv-HIR.js";import"./validateForm-CtIdfQW8.js";import"./SelectInput-CZz8WQiz.js";import"./index-CB1r69tB.js";import"./iconBase-DfiWWOnY.js";import"./useTheme-BdVR9D_r.js";import"./api-BP3h3n6A.js";const ye=()=>{const[d,f]=a.useState(""),[C,n]=a.useState(!1),[y,c]=a.useState(1),[u,j]=a.useState([]),[x,h]=a.useState([]),[w,g]=a.useState({}),[S,b]=a.useState(!0),[r,l]=a.useState({open:!1,message:"",id:0}),[o,m]=a.useState({open:!1,message:"",type:"success"}),[N,L]=a.useState(10),p=async()=>{b(!0);const i=(await z()).clients.map(t=>({id:t.id,nom:t.nom,prenom:t.prenom,CIN:t.CIN,email:t.email,telephone:t.telephone,localisation:t.localisation,surface_cultivee:t.surface_cultivee,type_activite_agricole:t.type_activite_agricole,created_via:t.created_via,is_payed:t.is_payed}));j(i),h(i),b(!1)};a.useEffect(()=>{p()},[]);const _=e=>{f(e),c(1);const i=u.filter(t=>(t==null?void 0:t.nom.toLowerCase().includes(e.toLowerCase()))||(t==null?void 0:t.prenom.toLowerCase().includes(e.toLowerCase()))||(t==null?void 0:t.telephone.toLowerCase().includes(e.toLowerCase()))||(t==null?void 0:t.surface_cultivee.toString().toLowerCase().includes(e.toLowerCase()))||(t==null?void 0:t.type_activite_agricole.toLowerCase().includes(e.toLowerCase()))||(t==null?void 0:t.localisation.toLowerCase().includes(e.toLowerCase())));h(i)},v=()=>{n(!0)},k=[{key:"id",label:"ID",sortable:!0,customRender:e=>s.jsx("div",{className:"text-sm",children:s.jsx("span",{children:e})})},{key:"nom",label:"Nom",sortable:!0},{key:"prenom",label:"Prénom",sortable:!0},{key:"CIN",label:"CIN"},{key:"email",label:"Email",sortable:!0},{key:"telephone",label:"Téléphone"},{key:"localisation",label:"Localisation",sortable:!0},{key:"type_activite_agricole",label:"Type d'activité agricole"},{key:"is_payed",label:"Statut",customRender:e=>s.jsx("span",{className:`text-sm font-medium ${e?"text-green-500":"text-red-500"}`,children:e?"Payé":"Non payé"})},{key:"created_via",label:"Via",customRender:e=>s.jsx("span",{className:"text-xl font-medium text-gray-900 dark:text-white",children:e==="web"?s.jsx(U,{}):s.jsx(q,{className:"text-blue-400"})})}],P=[{label:s.jsx(J,{className:"text-base"}),color:"text-green-500",hoverColor:"text-green-600",handler:e=>I(e.id)},{label:s.jsx(Q,{className:"text-lg"}),color:"text-blue-500",hoverColor:"text-blue-600",handler:e=>T(e)},{label:s.jsx(K,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:e=>E(e)}],D=e=>{p(),e&&m({...o,message:e,open:!0}),g({})},T=e=>{g(e),n(!0)},E=e=>{l({open:!0,message:`Êtes-vous sûr de vouloir supprimer ${e.nom} ${e.prenom}?`,id:e.id})},F=async()=>{const{message:e}=await B(r.id);m({...o,message:e,open:!0}),l({...r,open:!1,id:0}),p(),c(1)},I=async e=>{R.visit(`/client/${e}`)};return s.jsxs(W,{children:[s.jsx($,{title:"Maraîchers"}),s.jsx(O,{title:`Liste des Maraîchers ( Total: ${u.length} )`,handleClick:v,onSearch:_,search:d}),s.jsx(A,{setOpen:n,open:C,dataModify:w,onCloseFormulaire:D}),s.jsx(V,{message:o.message,type:o.type,duration:3e3,position:"top-right",show:o.open,onClose:()=>m({...o,message:"",open:!1})}),s.jsx(M,{open:r.open,message:r.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>l({...r,open:!1}),accept:F}),S?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"w-12 h-12 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):s.jsx("div",{children:x.length>0?s.jsx(G,{headers:k,rows:x,itemsPerPage:N,actions:P,className:"mt-4",currentPage:y,onPageChange:c,onItemsPerPageChange:e=>L(e)}):s.jsx(H,{nom:"maraîcher",search:d})})]})};export{ye as default};
