import{j as e,r as l,v as O,$ as R}from"./app-Cyd9xhLH.js";import{C as U}from"./ConfirmDialog-BtCXd3-2.js";import{E as W}from"./EmptyState-mAvrvCC4.js";import{H as z}from"./HeaderPage-CWZVp20S.js";import{S as G}from"./Snackbar-Cm3Je60F.js";import{y as I,F as J,v as K,z as Q}from"./constant-CIHZtd9e.js";import{M as X}from"./Modal-BwpCajKY.js";import{I as y}from"./InputLabel-Dw51ejW7.js";import{T as N,I as f}from"./TextInput-DVNf_BbI.js";import{f as Y}from"./validateForm-CYV7VTEV.js";import{a as L}from"./api-CYmHlwKl.js";import{S as Z}from"./SelectInput-tPDHgPxb.js";import{A as _}from"./AuthenticatedLayout-CYQ-r_ar.js";import"./index-BQEIpkbm.js";import"./iconBase-arXsq7GH.js";import"./transition-CW-Yh3Cj.js";import"./createLucideIcon-wZOBFVHe.js";import"./useTheme-D-97-V1T.js";import"./index-C4K58-H6.js";const ee=async()=>{try{return(await L.get("/technicien")).data}catch(s){throw console.error("Erreur lors de la récupération des techniciens",s),s}},te=async s=>{try{return(await L.post("/technicien",s)).data}catch(c){throw console.error("Erreur lors de l'enregistrement du technicien",c),c}},se=async s=>{try{return(await L.delete(`/technicien/${s}`)).data}catch(c){throw console.error("Erreur lors de la suppression du technicien",c),c}},ae=({technician:s,onDelete:c,onView:w})=>{const x=["#6B7280","#4B5563","#374151","#1F2937","#111827","#6B7280"],h=x[s.id%x.length],n=s.name.charAt(0).toUpperCase();return e.jsx("div",{className:"overflow-hidden transition-all duration-300 transform bg-white border border-gray-200 shadow-md dark:bg-gray-800 rounded-xl hover:shadow-lg hover:-translate-y-1 dark:border-gray-700",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex items-center px-6 py-5 mb-4 bg-gradient-to-br dark:from-blue-500 dark:to-purple-500 from-red-500 to-orange-500",children:[e.jsx("div",{className:"flex items-center justify-center mr-4 overflow-hidden bg-gray-100 border-2 border-gray-200 rounded-lg w-14 h-14 dark:border-gray-700 dark:bg-gray-700",children:s.photo?e.jsx("img",{src:s.photo,alt:s.name,className:"object-cover w-full h-full",onError:o=>{o.target.style.display="none",o.target.parentNode.style.backgroundColor=h,o.target.parentNode.innerHTML=n}}):e.jsx(I,{className:"text-2xl text-gray-500"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"mb-1 text-xl font-bold text-gray-100",children:s.name}),e.jsx("p",{className:"font-medium text-gray-200",children:s.speciality})]})]}),e.jsxs("div",{className:"px-6 pt-2 pb-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(J,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 truncate dark:text-gray-300",title:s.email,children:s.email})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(I,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.genre})]}),e.jsx("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:e.jsx("span",{className:"text-sm text-gray-700 truncate dark:text-gray-300",children:s.contact})})]}),e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(K,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.adress})]})]})]})})},re=({open:s=!1,setOpen:c,onCloseFormulaire:w=()=>{}})=>{const[x,h]=l.useState("Enregistrer"),[n,o]=l.useState({}),[j,C]=l.useState(!1),{data:d,setData:r,errors:i,reset:b}=O({name:"",email:"",contact:"",password:"",adress:"",speciality:"",genre:"Homme",photo:""}),g=a=>{c(!1),v(),w(a)},v=()=>{b(),o({})},p=async()=>{if(Y(d,o)){C(!0),h("Loading ..."),d.password=Q(8);try{let a;x==="Enregistrer"&&({message:a}=await te(d)),g(a)}catch(a){console.error("Error submitting payment:",a)}finally{C(!1),h("Enregistrer")}}};return e.jsxs(X,{show:s,closeable:!1,onClose:g,maxWidth:"xl",children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:"Nouveau Technicien"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"name",value:"Nom"}),e.jsx(N,{id:"name",name:"name",value:d.name,isFocused:!0,className:"block w-full mt-1",autoComplete:"name",onChange:a=>r("name",a.target.value),required:!0,onFocus:()=>o({...n,name:""})}),e.jsx(f,{message:n.name||i.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"email",value:"Email"}),e.jsx(N,{id:"email",name:"email",value:d.email,className:"block w-full mt-1",autoComplete:"email",onChange:a=>r("email",a.target.value),required:!0,onFocus:()=>o({...n,email:""})}),e.jsx(f,{message:n.email||i.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"genre",value:"Sexe"}),e.jsxs(Z,{id:"genre",type:"genre",name:"genre",value:d.genre,className:"block w-full mt-1",autoComplete:"genre",onChange:a=>r("genre",a.target.value),required:!0,children:[e.jsx("option",{value:"Homme",children:"Homme"}),e.jsx("option",{value:"Femme",children:"Femme"})]}),e.jsx(f,{message:i.genre,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"contact",value:"Contact"}),e.jsx(N,{id:"contact",name:"contact",value:d.contact,className:"block w-full mt-1",autoComplete:"contact",onChange:a=>r("contact",a.target.value),required:!0,onFocus:()=>o({...n,contact:""})}),e.jsx(f,{message:n.contact||i.contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"adress",value:"Adresse"}),e.jsx(N,{id:"adress",name:"adress",value:d.adress,className:"block w-full mt-1",autoComplete:"adress",onChange:a=>r("adress",a.target.value),required:!0,onFocus:()=>o({...n,adress:""})}),e.jsx(f,{message:n.adress||i.adress,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"speciality",value:"Spécialité"}),e.jsx(N,{id:"speciality",name:"speciality",value:d.speciality,className:"block w-full mt-1",autoComplete:"adress",onChange:a=>r("speciality",a.target.value),required:!0,onFocus:()=>o({...n,speciality:""})}),e.jsx(f,{message:n.speciality||i.speciality,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>g(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${j&&"opacity-25"}`,disabled:j,onClick:p,children:x})]})]})},Ce=()=>{const[s,c]=l.useState(""),[w,x]=l.useState(!1),[h,n]=l.useState([]),[o,j]=l.useState([]),[C,d]=l.useState(!0),[r,i]=l.useState(1),[b]=l.useState(8),[g,v]=l.useState({open:!1,message:"",id:0}),[p,a]=l.useState({open:!1,message:"",type:"success"}),S=async()=>{d(!0);const{data:t}=await ee(),F=t.map(m=>({id:m.technicien.id,name:m.name,email:m.email,genre:m.technicien.genre,contact:m.technicien.contact,adress:m.technicien.adress,speciality:m.technicien.speciality,photo:m.technicien.photo}));n(F),j(F),d(!1)};l.useEffect(()=>{S()},[]);const M=t=>{c(t),i(1);const F=h.filter(m=>m.name.toLowerCase().includes(t.toLowerCase())||m.email.toLowerCase().includes(t.toLowerCase())||m.speciality.toLowerCase().includes(t.toLowerCase()));j(F)},$=t=>{S(),t&&a({...p,message:t,open:!0})},A=t=>{console.log("View details for ID:",t)},q=t=>{v({open:!0,message:`Êtes-vous sûr de vouloir supprimer le technicien ${t.name} ?`,id:t.id})},H=async()=>{const{message:t}=await se(g.id);a({...p,message:t,open:!0}),v({...g,open:!1,id:0}),S(),i(1)},P=r*b,B=P-b,V=o.slice(B,P),u=Math.ceil(o.length/b),D=[],T=5;let E=Math.max(1,r-Math.floor(T/2)),k=E+T-1;k>u&&(k=u,E=Math.max(1,k-T+1));for(let t=E;t<=k;t++)D.push(t);return e.jsxs(_,{children:[e.jsx(R,{title:"Technicien"}),e.jsx(z,{handleClick:()=>x(!0),title:`Liste des Techniciens ( Total: ${h.length} )`,search:s,onSearch:M}),e.jsx(re,{open:w,setOpen:x,onCloseFormulaire:$}),e.jsx(G,{message:p.message,type:p.type,duration:3e3,position:"top-right",show:p.open,onClose:()=>a({...p,message:"",open:!1})}),e.jsx(U,{open:g.open,message:g.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>v({...g,open:!1}),accept:H}),C?e.jsx("div",{className:"flex flex-col items-center justify-center h-64 p-8 rounded-xl",children:e.jsx("div",{className:"w-12 h-12 mb-4 border-t-2 border-b-2 border-indigo-500 rounded-full animate-spin"})}):e.jsx(e.Fragment,{children:o.length>0?e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:V.map(t=>e.jsx(ae,{technician:t,onDelete:q,onView:A},t.id))}),u>1&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center px-2 py-2 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>i(1),disabled:r===1,className:`mx-1 p-2 rounded-md ${r===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Première page",children:"«"}),e.jsx("button",{onClick:()=>i(t=>Math.max(t-1,1)),disabled:r===1,className:`mx-1 p-2 rounded-md ${r===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page précédente",children:"‹"}),D.map(t=>e.jsx("button",{onClick:()=>i(t),className:`mx-1 w-9 h-9 flex items-center justify-center rounded-md ${r===t?"bg-indigo-600 text-white font-medium":"text-gray-700 hover:bg-indigo-50"}`,children:t},t)),e.jsx("button",{onClick:()=>i(t=>Math.min(t+1,u)),disabled:r===u,className:`mx-1 p-2 rounded-md ${r===u?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page suivante",children:"›"}),e.jsx("button",{onClick:()=>i(u),disabled:r===u,className:`mx-1 p-2 rounded-md ${r===u?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Dernière page",children:"»"})]})})]}):e.jsx(W,{nom:"technicien",search:s})})]})};export{Ce as default};
