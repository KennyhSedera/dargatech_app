import{r as v,v as E,j as e,m as k}from"./app-BinU7nh5.js";import{M as q}from"./Modal-D7sCRa1e.js";import{T as m,I as n}from"./TextInput-YJDn3mPB.js";import{I as c}from"./InputLabel-C4IRUL8v.js";import{u as T,c as S}from"./clientService-CXWDmTpe.js";import{d as H}from"./validateForm-DkOh89YH.js";import{S as L}from"./SelectInput-CEaKZesC.js";const V=({open:C=!0,setOpen:N,dataModify:t={},onCloseFormulaire:b=()=>{},token_data:F})=>{const[f,u]=v.useState("Enregistrer"),[a,o]=v.useState({}),[h,g]=v.useState(!1),{data:s,setData:r,errors:i,reset:I}=E({nom:"",prenom:"",email:"",genre:"Homme",CIN:"",telephone:"",pays:"Togo",ville:"Kara",localisation:"",surface_cultivee:"",type_activite_agricole:"",created_via:F?"telegram_bot":"web"}),p=l=>{N(!1),x(),b(l)},x=()=>{I(),u("Enregistrer"),o({}),g(!1)};v.useEffect(()=>{var l,j,d,_;t.id?(r({nom:t.nom||"",prenom:t.prenom||"",email:t.email||"",genre:t.genre||"Homme",CIN:t.CIN||"",telephone:t.telephone||"",pays:((l=t.localisation)==null?void 0:l.pays)||"Togo",ville:((j=t.localisation)==null?void 0:j.ville)||"Kara",quartier:((d=t.localisation)==null?void 0:d.quartier)||"",village:((_=t.localisation)==null?void 0:_.village)||"",localisation:(t==null?void 0:t.localisation)||"",surface_cultivee:t.surface_cultivee||"",type_activite_agricole:t.type_activite_agricole||"",created_via:t.created_via||"web",ville_acheteur:t.ville_acheteur||"",pays_acheteur:t.pays_acheteur||""}),u("Modifier")):x()},[t,r]);const w=async()=>{if(H(s,o)){g(!0),u(t.id?"Modification...":"Enregistrement...");try{if(t.id)await T(t.id,s),p("Client modifié avec succès !");else{const l=await S(s);p("Client créé avec succès !"),k.visit("/form/paiement",{method:"get",data:{client_id:l.client.id,amount:3e4,designation:"Acompte pour signature de contrat et installation"}})}}catch(l){console.error("Erreur:",l),g(!1),u(t.id?"Modifier":"Enregistrer")}}};return e.jsxs(q,{show:C,closeable:!1,onClose:p,maxWidth:"4xl",children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:t.id?"Modifier un Maraîcher":"Ajouter un Maraîcher"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"nom",value:"Nom"}),e.jsx(m,{id:"nom",name:"nom",value:s.nom,className:"block w-full mt-1",autoComplete:"nom",isFocused:!0,onChange:l=>r("nom",l.target.value),required:!0,onFocus:()=>o({...a,nom:""})}),e.jsx(n,{message:a.nom||i.nom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"prenom",value:"Prénom"}),e.jsx(m,{id:"prenom",name:"prenom",value:s.prenom,className:"block w-full mt-1",autoComplete:"prenom",onChange:l=>r("prenom",l.target.value),required:!0,onFocus:()=>o({...a,prenom:""})}),e.jsx(n,{message:a.prenom||i.prenom,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"email",value:"Email"}),e.jsx(m,{id:"email",name:"email",value:s.email,className:"block w-full mt-1",autoComplete:"email",onChange:l=>r("email",l.target.value),onFocus:()=>o({...a,email:""})}),e.jsx(n,{message:a.email||i.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"genre",value:"Sexe"}),e.jsxs(L,{id:"genre",type:"genre",name:"genre",value:s.genre,className:"block w-full mt-1",autoComplete:"genre",onChange:l=>r("genre",l.target.value),required:!0,children:[e.jsx("option",{value:"Homme",children:"Homme"}),e.jsx("option",{value:"Femme",children:"Femme"})]}),e.jsx(n,{message:i.genre,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"CIN",value:"Pièce d'identité"}),e.jsx(m,{id:"CIN",name:"CIN",value:s.CIN,className:"block w-full mt-1",autoComplete:"CIN",onChange:l=>r("CIN",l.target.value),required:!0,onFocus:()=>o({...a,CIN:""})}),e.jsx(n,{message:a.CIN||i.CIN,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"telephone",value:"Téléphone"}),e.jsx(m,{id:"telephone",name:"telephone",value:s.telephone,className:"block w-full mt-1",autoComplete:"telephone",onChange:l=>r("telephone",l.target.value),required:!0,onFocus:()=>o({...a,telephone:""})}),e.jsx(n,{message:a.telephone||i.telephone,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"localisation",value:"Localisation ou adresse"}),e.jsx(m,{id:"localisation",name:"localisation",value:s.localisation,className:"block w-full mt-1",autoComplete:"localisation",onChange:l=>r("localisation",l.target.value),required:!0,onFocus:()=>o({...a,localisation:""})}),e.jsx(n,{message:a.localisation||i.localisation,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"type_activite_agricole",value:"Type activité agricole"}),e.jsx(m,{id:"type_activite_agricole",name:"type_activite_agricole",value:s.type_activite_agricole,className:"block w-full mt-1",autoComplete:"type_activite_agricole",onChange:l=>r("type_activite_agricole",l.target.value),required:!0,onFocus:()=>o({...a,type_activite_agricole:""})}),e.jsx(n,{message:a.type_activite_agricole||i.type_activite_agricole,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"surface_cultivee",value:"Surface cultivée (en ha)"}),e.jsx(m,{id:"surface_cultivee",name:"surface_cultivee",value:s.surface_cultivee,className:"block w-full mt-1",autoComplete:"surface_cultivee",onChange:l=>r("surface_cultivee",l.target.value),required:!0,onFocus:()=>o({...a,surface_cultivee:""})}),e.jsx(n,{message:a.surface_cultivee||i.surface_cultivee,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>p(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${h&&"opacity-25"}`,disabled:h,onClick:w,children:f})]})]})};export{V as F};
