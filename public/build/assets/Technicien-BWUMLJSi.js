import{r as n,m as A,j as e,L as I}from"./app-CGtbL635.js";import{C as q,D as P,G as H}from"./index-dpia1B2V.js";import{H as $}from"./HeaderPage-Ckkr_o-l.js";import{S as G}from"./Snackbar-TZVNPHse.js";import{M}from"./Modal-DSxLoGSv.js";import{I as x}from"./InputLabel-6zlZrN36.js";import{T as b,I as g}from"./TextInput-DRkm6zI0.js";import{f as R}from"./validateForm-C-Be7ugn.js";import{a as F}from"./api-WN51MiIe.js";import{S as W}from"./SelectInput-Ba7Mr7dH.js";import{z,n as B,j as O}from"./constant-Cb5i93RA.js";import{A as V}from"./AuthenticatedLayout-DBB9uj4u.js";import"./iconBase-DQgVeGog.js";import"./index-CTTOyiqn.js";import"./transition-MTEsyXJd.js";import"./index-CQHpVg1P.js";import"./index-C1o-hH6g.js";import"./useTheme-BpExcT7I.js";const _=async()=>{try{return(await F.get("/technicien")).data}catch(o){throw console.error("Erreur lors de la récupération des techniciens",o),o}},J=async o=>{try{return(await F.post("/technicien",o)).data}catch(i){throw console.error("Erreur lors de l'enregistrement du technicien",i),i}},K=async o=>{try{return(await F.delete(`/technicien/${o}`)).data}catch(i){throw console.error("Erreur lors de la suppression du technicien",i),i}},Q=({open:o=!1,setOpen:i,onCloseFormulaire:N=()=>{}})=>{const[f,v]=n.useState("Enregistrer"),[a,c]=n.useState({}),[C,j]=n.useState(!1),{data:r,setData:d,errors:l,reset:p}=A({name:"",email:"",contact:"",password:"",adress:"",speciality:"",genre:"Homme",photo:""}),h=s=>{i(!1),u(),N(s)},u=()=>{p(),c({})},y=async()=>{if(R(r,c)){j(!0),v("Loading ..."),r.password=z(8);try{let s;f==="Enregistrer"&&({message:s}=await J(r)),h(s)}catch(s){console.error("Error submitting payment:",s)}finally{j(!1),v("Enregistrer")}}};return e.jsxs(M,{show:o,closeable:!1,onClose:h,maxWidth:"xl",children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:"Nouveau Technicien"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",value:"Nom"}),e.jsx(b,{id:"name",name:"name",value:r.name,isFocused:!0,className:"block w-full mt-1",autoComplete:"name",onChange:s=>d("name",s.target.value),required:!0,onFocus:()=>c({...a,name:""})}),e.jsx(g,{message:a.name||l.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"email",value:"Email"}),e.jsx(b,{id:"email",name:"email",value:r.email,className:"block w-full mt-1",autoComplete:"email",onChange:s=>d("email",s.target.value),required:!0,onFocus:()=>c({...a,email:""})}),e.jsx(g,{message:a.email||l.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"genre",value:"Sexe"}),e.jsxs(W,{id:"genre",type:"genre",name:"genre",value:r.genre,className:"block w-full mt-1",autoComplete:"genre",onChange:s=>d("genre",s.target.value),required:!0,children:[e.jsx("option",{value:"Homme",children:"Homme"}),e.jsx("option",{value:"Femme",children:"Femme"})]}),e.jsx(g,{message:l.genre,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"contact",value:"Contact"}),e.jsx(b,{id:"contact",name:"contact",value:r.contact,className:"block w-full mt-1",autoComplete:"contact",onChange:s=>d("contact",s.target.value),required:!0,onFocus:()=>c({...a,contact:""})}),e.jsx(g,{message:a.contact||l.contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"adress",value:"Adresse"}),e.jsx(b,{id:"adress",name:"adress",value:r.adress,className:"block w-full mt-1",autoComplete:"adress",onChange:s=>d("adress",s.target.value),required:!0,onFocus:()=>c({...a,adress:""})}),e.jsx(g,{message:a.adress||l.adress,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"speciality",value:"Spécialité"}),e.jsx(b,{id:"speciality",name:"speciality",value:r.speciality,className:"block w-full mt-1",autoComplete:"adress",onChange:s=>d("speciality",s.target.value),required:!0,onFocus:()=>c({...a,speciality:""})}),e.jsx(g,{message:a.speciality||l.speciality,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>h(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${C&&"opacity-25"}`,disabled:C,onClick:y,children:f})]})]})},he=()=>{const[o,i]=n.useState(""),[N,f]=n.useState(!1),[v,a]=n.useState(1),[c,C]=n.useState([]),[j,r]=n.useState([]),[d,l]=n.useState(!0),[p,h]=n.useState({open:!1,message:"",id:0}),[u,y]=n.useState({open:!1,message:"",type:"success"}),s=[{key:"id",label:"ID"},{key:"name",label:"Nom technichien"},{key:"email",label:"Adresse email"},{key:"genre",label:"Sexe"},{key:"contact",label:"Contact"},{key:"adress",label:"Adresse local"},{key:"speciality",label:"Spécialité"}],k=[{label:e.jsx(O,{className:"text-base"}),color:"text-green-500",hoverColor:"text-green-600",handler:t=>showDetail(t.id)},{label:e.jsx(H,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:t=>L(t)}],S=async()=>{l(!0);const{data:t}=await _(),w=t.map(m=>({id:m.technicien.id,name:m.name,email:m.email,genre:m.genre,contact:m.technicien.contact,adress:m.technicien.adress,speciality:m.technicien.speciality}));C(w),r(w),l(!1)};n.useEffect(()=>{S()},[]);const T=t=>{i(t),a(1);const w=c.filter(m=>m.name.toLowerCase().includes(t.toLowerCase()));r(w)},E=t=>{S(),t&&y({...u,message:t,open:!0})},L=t=>{h({open:!0,message:`Êtes-vous sûr de vouloir supprimer le technicien ${t.name} ?`,id:t.id})},D=async()=>{const{message:t}=await K(p.id);y({...u,message:t,open:!0}),h({...p,open:!1,id:0}),S(),a(1)};return e.jsxs(V,{children:[e.jsx(I,{title:"Technicien"}),e.jsx($,{handleClick:()=>f(!0),title:"Liste des Techniciens",search:o,onSearch:T}),e.jsx(Q,{open:N,setOpen:f,onCloseFormulaire:E}),e.jsx(G,{message:u.message,type:u.type,duration:3e3,position:"top-right",show:u.open,onClose:()=>y({...u,message:"",open:!1})}),e.jsx(q,{open:p.open,message:p.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>h({...p,open:!1}),accept:D}),d?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsx("div",{children:j.length>0?e.jsx(P,{headers:s,rows:j,itemsPerPage:10,actions:k,className:"mt-4",currentPage:v,onPageChange:a,masqueColumns:["client_id"]}):e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:B,alt:"no data",className:"max-w-md opacity-50 mt-2"})})})]})};export{he as default};
