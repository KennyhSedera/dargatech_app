import{r as s,j as t,L as g}from"./app-BkC8VWgr.js";import{A as j,f as b}from"./AuthenticatedLayout-BevpI5nv.js";import"./transition-CGbVp9qO.js";import"./constant-B050u7nx.js";import"./useTheme-ZuXOj12l.js";import"./index-C9tktaFt.js";function S(){var u;const[r,i]=s.useState(""),[o,d]=s.useState([]),n="+261349287065",c=s.useRef(null),[h,f]=s.useState(!0),x="https://dargatech.crm.railway.app/",p=async()=>{r&&(d([...o,{text:r,sender:"Bot",created_at:new Date}]),i(""),await fetch(`${x}sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:n,message:r})}),setTimeout(l,1e3))},l=async()=>{const a=await(await fetch(`${x}messages/${n}`)).json();d(a)};s.useEffect(()=>{{l();const e=setInterval(l,2e3);return()=>clearInterval(e)}},[n]),s.useEffect(()=>{const e=c.current;e&&h&&(e.scrollTop=e.scrollHeight)},[o]);const m=()=>{const e=c.current;if(e){const a=e.scrollHeight-e.scrollTop<=e.clientHeight+50;f(a)}};return t.jsxs(j,{children:[t.jsx(g,{title:"Bot Telegram"}),t.jsxs("div",{className:"h-[calc(100vh-74px)] w-3/4 flex flex-col",children:[t.jsx("h2",{className:"p-4 border-b font-semibold text-xl",children:(u=o[0])==null?void 0:u.sender}),t.jsx("div",{className:"flex-1 overflow-auto px-4 py-2 custom-scrollbar",ref:c,onScroll:m,children:o.map((e,a)=>t.jsx("div",{className:`w-full flex ${e.sender==="Bot"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:"max-w-md mb-2 flex flex-col",children:[t.jsx("div",{className:`${e.sender==="Bot"?"bg-red-400":"bg-green-400"} px-4 py-2 rounded-xl`,children:e.text}),t.jsx("div",{className:`text-xs text-gray-500 ${e.sender==="Bot"?"text-end":"text-start"}`,children:b(e.created_at)})]})},a))}),t.jsxs("div",{className:"p-2 flex items-center gap-2 border-t",children:[t.jsx("textarea",{className:"flex-1 p-2 rounded-lg bg-transparent border border-gray-300 focus:ring-2 focus:ring-blue-700",value:r,onChange:e=>i(e.target.value),placeholder:"Ã‰cris un message..."}),t.jsx("button",{className:"px-4 py-2 bg-blue-400 text-white rounded-lg",onClick:p,children:"Envoyer"})]})]})]})}export{S as default};
