import{v as E,r as t,j as e,e as A}from"./app-BNenjPtp.js";import{C as M}from"./ConfirmDialog-Nv1gZIbe.js";import{H as R}from"./HeaderPage-Bp8wOM3r.js";import{u as $}from"./api-BZPzo5b0.js";import{T as G,I as D}from"./TextInput-85TkMtt6.js";import{I as F}from"./InputLabel-dhwV7XHG.js";import{S as I}from"./Snackbar-BJpSLYhn.js";import{I as H}from"./InputImage-D5Rx6LLG.js";import{b as O}from"./validateForm-CtIdfQW8.js";import{g as q,d as B}from"./TypePaiementService-B5D_Tn-t.js";import{E as U}from"./EmptyState-C-E3oC5i.js";import{G as V}from"./index-DK6_t6bK.js";import"./Modal-Db5Z9qxK.js";import"./transition-CnJcRsbU.js";import"./constant-BuBAA7rl.js";import"./iconBase-J33Fup2I.js";import"./index-DEJ-GHG7.js";import"./createLucideIcon-Cc2V0G-b.js";const z=({reload:o=()=>{}})=>{const{data:a,setData:j,errors:v,reset:m}=E({name:"",logo_path:null}),[r,x]=t.useState({open:!1,message:"",type:"success"}),[p,l]=t.useState({}),N=t.useRef(null),[P,f]=t.useState("Ajouter"),[d,u]=t.useState(!1),c=async()=>{var S,_,h;if(!O(a,l))return;const n=new FormData;n.append("name",a.name),a.logo_path&&n.append("logo_path",a.logo_path),u(!0),f("Loading ...");try{const{data:i}=await A.post(`${$}/type_paiement`,n);x({open:!0,message:i.message,type:"success"})}catch(i){console.error("Erreur:",((S=i.response)==null?void 0:S.data)||i.message),x({open:!0,message:((h=(_=i.response)==null?void 0:_.data)==null?void 0:h.message)||"Une erreur est survenue",type:"error"})}finally{g()}},w=n=>{j({...a,logo_path:n})},g=()=>{m(),f("Ajouter"),u(!1),l({}),o()};return e.jsxs("div",{className:"w-full p-4 mt-4 bg-white rounded-lg shadow-sm dark:bg-gray-800",children:[e.jsx(I,{message:r.message,type:r.type,duration:3e3,position:"top-right",show:r.open,onClose:()=>x({...r,message:"",open:!1})}),e.jsx("div",{className:"text-lg font-semibold text-center",children:"Nouveau"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"type_name",value:"Nom"}),e.jsx(G,{id:"type_name",isFocused:!0,name:"type_name",value:a.name,className:"block w-full mt-1",autoComplete:"type_name",onChange:n=>j("name",n.target.value),required:!0,placeholder:"Nom de la type",onFocus:()=>l({...p,name:""})}),e.jsx(D,{message:p.name||v.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(F,{htmlFor:"logo_path",value:"Logo"}),e.jsx(H,{ref:N,selectedFile:a.logo_path,onLoadFile:w,onFocus:()=>l({...p,logo_path:""}),multiple:!1,placeholder:"Sélectionner un logo"}),e.jsx(D,{message:p.logo_path||v.logo_path,className:"mt-2"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("button",{className:"w-auto px-4 py-1 mr-2 text-red-600 rounded-md bg-red-400/20 disabled:cursor-not-allowed",onClick:g,type:"button",children:"Annuler"}),e.jsx("button",{disabled:d,className:"w-auto px-4 py-1 text-white bg-blue-500 rounded-md disabled:cursor-not-allowed disabled:opacity-10",onClick:c,type:"button",children:P})]})]})},J=({item:o,onDelete:a})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-white dark:border-gray-800 rounded-lg relative shadow-md",children:[e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx("button",{onClick:()=>a(o),className:"p-2 text-red-500 rounded-full bg-red-100 transition-colors",children:e.jsx(V,{className:"text-lg"})})}),e.jsx("div",{className:"h-40 w-full bg-gray-100 dark:bg-gray-900 rounded-t-lg overflow-hidden",children:o.logo_path?e.jsx("img",{src:o.logo_path,alt:`Logo ${o.name}`,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:"No Logo"})}),e.jsx("div",{className:"text-center p-4 font-semibold",children:o.name})]}),pe=()=>{const[o,a]=t.useState(""),[j,v]=t.useState({}),[m,r]=t.useState(1),[x,p]=t.useState([]),[l,N]=t.useState([]),[P,f]=t.useState(!0),[d,u]=t.useState({open:!1,message:"",id:0}),[c,w]=t.useState({open:!1,message:"",type:"success"}),g=async()=>{f(!0);try{const{type:s}=await q(),C=s.map(b=>({id:b.id,name:b.name,logo_path:b.logo_path}));p(C),N(C)}catch(s){console.log(s)}finally{f(!1)}};t.useEffect(()=>{g()},[]);const n=s=>{u({open:!0,message:`Êtes-vous sûr de vouloir supprimer la type de paiement par ${s.name} ?`,id:s.id})},S=async()=>{const{message:s}=await B(d.id);w({...c,message:s,open:!0}),u({...d,open:!1,id:0}),g(),r(1)},_=s=>{a(s),r(1);const C=x.filter(b=>b.name.toString().toLowerCase().includes(s.toLowerCase()));N(C)},h=8,i=m*h,T=i-h,L=l.slice(T,i),y=Math.ceil(l.length/h),k=()=>e.jsxs("div",{className:"flex justify-center mt-8",children:[e.jsx("button",{onClick:()=>r(s=>Math.max(s-1,1)),disabled:m===1,className:"px-4 py-2 mx-1 rounded-full border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Précédent"}),e.jsx("div",{className:"flex items-center mx-4",children:e.jsxs("span",{className:"text-gray-700",children:["Page ",m," sur ",y||1]})}),e.jsx("button",{onClick:()=>r(s=>Math.min(s+1,y)),disabled:m===y||y===0,className:"px-4 py-2 mx-1 rounded-full border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Suivant"})]});return e.jsxs("div",{children:[e.jsx(R,{search:o,onSearch:_,title:"Liste des types de paiement",btn:!1}),e.jsx(I,{message:c.message,type:c.type,duration:3e3,position:"top-right",show:c.open,onClose:()=>w({...c,message:"",open:!1})}),e.jsx(M,{open:d.open,message:d.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>u({...d,open:!1}),accept:S}),P?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsx("div",{className:"sm:col-span-2",children:l.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mt-6",children:L.map(s=>e.jsx(J,{item:s,onDelete:n},s.id))}),y>1&&e.jsx(k,{})]}):e.jsx(U,{nom:"type de paiement",search:o})}),e.jsx("div",{className:"sm:col-span-1",children:e.jsx(z,{reload:()=>g(),dataToModify:j,setDataToModify:v})})]})]})};export{pe as default};
