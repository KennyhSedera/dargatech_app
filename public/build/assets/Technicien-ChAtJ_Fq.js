import{j as e,r as m,v as V,$ as O}from"./app-BnfMQvxq.js";import{C as R}from"./ConfirmDialog-CdpTlPTj.js";import{E as U}from"./EmptyState-CTIBF28O.js";import{H as W}from"./HeaderPage-CZWZ6O2a.js";import{S as z}from"./Snackbar-B2c2tOIv.js";import{x as D,F as G,u as J,y as K,z as Q}from"./constant-Dk9Kdd19.js";import{M as X}from"./Modal-DDNybxIi.js";import{I as y}from"./InputLabel-BXSq3UgH.js";import{T as f,I as j}from"./TextInput-CGj6Bb-g.js";import{c as Y}from"./validateForm-CtIdfQW8.js";import{a as _}from"./api-Cp0_Hi7d.js";import{S as Z}from"./SelectInput-CNRxsmbW.js";import{A as ee}from"./AuthenticatedLayout-Cz--Stba.js";import"./index-2pBSTZ1p.js";import"./iconBase-utKPuQ6U.js";import"./transition-DGMlf8MY.js";import"./createLucideIcon-C9_T_IXk.js";import"./useTheme-CuJKLB2G.js";import"./index-Fqv8w8cp.js";const se=({technician:t,onDelete:d,onView:w})=>{const x=["#6B7280","#4B5563","#374151","#1F2937","#111827","#6B7280"],h=x[t.id%x.length],o=t.name.charAt(0).toUpperCase();return e.jsx("div",{className:"overflow-hidden transition-all duration-300 transform bg-white border border-gray-200 shadow-md dark:bg-gray-800 rounded-xl hover:shadow-lg hover:-translate-y-1 dark:border-gray-700",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex items-center px-6 py-5 mb-4 bg-gradient-to-br dark:from-blue-500 dark:to-purple-500 from-red-500 to-orange-500",children:[e.jsx("div",{className:"flex items-center justify-center mr-4 overflow-hidden bg-gray-100 border-2 border-gray-200 rounded-lg w-14 h-14 dark:border-gray-700 dark:bg-gray-700",children:t.photo?e.jsx("img",{src:t.photo,alt:t.name,className:"object-cover w-full h-full",onError:n=>{n.target.style.display="none",n.target.parentNode.style.backgroundColor=h,n.target.parentNode.innerHTML=o}}):e.jsx(D,{className:"text-2xl text-gray-500"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"mb-1 text-xl font-bold text-gray-100",children:t.name}),e.jsx("p",{className:"font-medium text-gray-200",children:t.speciality})]})]}),e.jsxs("div",{className:"px-6 pt-2 pb-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(G,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 truncate dark:text-gray-300",title:t.email,children:t.email})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(D,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.genre})]}),e.jsx("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:e.jsx("span",{className:"text-sm text-gray-700 truncate dark:text-gray-300",children:t.contact})})]}),e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(J,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.adress})]}),t.telegram_username&&e.jsxs("div",{className:"relative flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(K,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.telegram_username}),e.jsx("span",{className:"absolute right-2",children:t.bot_active?"âœ…":"ðŸš«"})]})]})]})})},te=async()=>{try{return(await _.get("/technicien")).data}catch(t){throw console.error("Erreur lors de la rÃ©cupÃ©ration des techniciens",t),t}},ae=async t=>{try{return(await _.post("/technicien",t)).data}catch(d){throw console.error("Erreur lors de l'enregistrement du technicien",d),d}},re=async t=>{try{return(await _.delete(`/technicien/${t}`)).data}catch(d){throw console.error("Erreur lors de la suppression du technicien",d),d}},oe=({open:t=!1,setOpen:d,onCloseFormulaire:w=()=>{}})=>{const[x,h]=m.useState("Enregistrer"),[o,n]=m.useState({}),[b,C]=m.useState(!1),{data:c,setData:r,errors:l,reset:v}=V({name:"",email:"",contact:"",password:"",adress:"",speciality:"",genre:"Homme",photo:"",telegram_username:""}),g=a=>{d(!1),N(),w(a)},N=()=>{v(),n({})},p=async()=>{if(Y(c,n)){C(!0),h("Loading ..."),c.password=Q(8);try{let a;x==="Enregistrer"&&({message:a}=await ae(c)),g(a)}catch(a){console.error("Error submitting payment:",a)}finally{C(!1),h("Enregistrer")}}};return e.jsxs(X,{show:t,closeable:!1,onClose:g,maxWidth:"4xl",children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:"Nouveau Technicien"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"name",value:"Nom"}),e.jsx(f,{id:"name",name:"name",value:c.name,isFocused:!0,className:"block w-full mt-1",autoComplete:"name",onChange:a=>r("name",a.target.value),required:!0,onFocus:()=>n({...o,name:""})}),e.jsx(j,{message:o.name||l.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"email",value:"Email"}),e.jsx(f,{id:"email",name:"email",value:c.email,className:"block w-full mt-1",autoComplete:"email",onChange:a=>r("email",a.target.value),required:!0,onFocus:()=>n({...o,email:""})}),e.jsx(j,{message:o.email||l.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"genre",value:"Sexe"}),e.jsxs(Z,{id:"genre",type:"genre",name:"genre",value:c.genre,className:"block w-full mt-1",autoComplete:"genre",onChange:a=>r("genre",a.target.value),required:!0,children:[e.jsx("option",{value:"Homme",children:"Homme"}),e.jsx("option",{value:"Femme",children:"Femme"})]}),e.jsx(j,{message:l.genre,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"contact",value:"Contact"}),e.jsx(f,{id:"contact",name:"contact",value:c.contact,className:"block w-full mt-1",autoComplete:"contact",onChange:a=>r("contact",a.target.value),required:!0,onFocus:()=>n({...o,contact:""})}),e.jsx(j,{message:o.contact||l.contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"adress",value:"Adresse"}),e.jsx(f,{id:"adress",name:"adress",value:c.adress,className:"block w-full mt-1",autoComplete:"adress",onChange:a=>r("adress",a.target.value),required:!0,onFocus:()=>n({...o,adress:""})}),e.jsx(j,{message:o.adress||l.adress,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"speciality",value:"SpÃ©cialitÃ©"}),e.jsx(f,{id:"speciality",name:"speciality",value:c.speciality,className:"block w-full mt-1",autoComplete:"adress",onChange:a=>r("speciality",a.target.value),required:!0,onFocus:()=>n({...o,speciality:""})}),e.jsx(j,{message:o.speciality||l.speciality,className:"mt-2"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(y,{htmlFor:"telegram_username",value:"Pseudo sur telegram"}),e.jsx(f,{id:"telegram_username",name:"telegram_username",value:c.telegram_username,className:"block w-full mt-1",autoComplete:"telegram_username",onChange:a=>r("telegram_username",a.target.value),required:!0,onFocus:()=>n({...o,telegram_username:""})}),e.jsx(j,{message:o.telegram_username||l.telegram_username,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>g(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${b&&"opacity-25"}`,disabled:b,onClick:p,children:x})]})]})},ke=()=>{const[t,d]=m.useState(""),[w,x]=m.useState(!1),[h,o]=m.useState([]),[n,b]=m.useState([]),[C,c]=m.useState(!0),[r,l]=m.useState(1),[v]=m.useState(8),[g,N]=m.useState({open:!1,message:"",id:0}),[p,a]=m.useState({open:!1,message:"",type:"success"}),S=async()=>{c(!0);const{data:s}=await te(),F=s.map(i=>({id:i.technicien.id,name:i.name,email:i.email,genre:i.technicien.genre,contact:i.technicien.contact,adress:i.technicien.adress,speciality:i.technicien.speciality,photo:i.technicien.photo,telegram_username:i.technicien.telegram_username,bot_active:i.technicien.bot_active}));o(F),b(F),c(!1)};m.useEffect(()=>{S()},[]);const I=s=>{d(s),l(1);const F=h.filter(i=>i.name.toLowerCase().includes(s.toLowerCase())||i.email.toLowerCase().includes(s.toLowerCase())||i.speciality.toLowerCase().includes(s.toLowerCase()));b(F)},M=s=>{S(),s&&a({...p,message:s,open:!0})},$=s=>{console.log("View details for ID:",s)},A=s=>{N({open:!0,message:`ÃŠtes-vous sÃ»r de vouloir supprimer le technicien ${s.name} ?`,id:s.id})},q=async()=>{const{message:s}=await re(g.id);a({...p,message:s,open:!0}),N({...g,open:!1,id:0}),S(),l(1)},L=r*v,H=L-v,B=n.slice(H,L),u=Math.ceil(n.length/v),P=[],T=5;let E=Math.max(1,r-Math.floor(T/2)),k=E+T-1;k>u&&(k=u,E=Math.max(1,k-T+1));for(let s=E;s<=k;s++)P.push(s);return e.jsxs(ee,{children:[e.jsx(O,{title:"Technicien"}),e.jsx(W,{handleClick:()=>x(!0),title:`Liste des Techniciens ( Total: ${h.length} )`,search:t,onSearch:I}),e.jsx(oe,{open:w,setOpen:x,onCloseFormulaire:M}),e.jsx(z,{message:p.message,type:p.type,duration:3e3,position:"top-right",show:p.open,onClose:()=>a({...p,message:"",open:!1})}),e.jsx(R,{open:g.open,message:g.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>N({...g,open:!1}),accept:q}),C?e.jsx("div",{className:"flex flex-col items-center justify-center h-64 p-8 rounded-xl",children:e.jsx("div",{className:"w-12 h-12 mb-4 border-t-2 border-b-2 border-indigo-500 rounded-full animate-spin"})}):e.jsx(e.Fragment,{children:n.length>0?e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:B.map(s=>e.jsx(se,{technician:s,onDelete:A,onView:$},s.id))}),u>1&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center px-2 py-2 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>l(1),disabled:r===1,className:`mx-1 p-2 rounded-md ${r===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"PremiÃ¨re page",children:"Â«"}),e.jsx("button",{onClick:()=>l(s=>Math.max(s-1,1)),disabled:r===1,className:`mx-1 p-2 rounded-md ${r===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page prÃ©cÃ©dente",children:"â€¹"}),P.map(s=>e.jsx("button",{onClick:()=>l(s),className:`mx-1 w-9 h-9 flex items-center justify-center rounded-md ${r===s?"bg-indigo-600 text-white font-medium":"text-gray-700 hover:bg-indigo-50"}`,children:s},s)),e.jsx("button",{onClick:()=>l(s=>Math.min(s+1,u)),disabled:r===u,className:`mx-1 p-2 rounded-md ${r===u?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page suivante",children:"â€º"}),e.jsx("button",{onClick:()=>l(u),disabled:r===u,className:`mx-1 p-2 rounded-md ${r===u?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"DerniÃ¨re page",children:"Â»"})]})})]}):e.jsx(U,{nom:"technicien",search:t})})]})};export{ke as default};
