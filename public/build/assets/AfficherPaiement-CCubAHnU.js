import{r as t,j as e,$ as w,d as g}from"./app-DX81JdZj.js";import{M as p,N,O as v}from"./constant-CZa3NPxg.js";import{h as k}from"./html2pdf-BCsRcXgQ.js";import{F as y}from"./FichierPaiementPdf-CeL-nn6r.js";import"./iconBase-NQ_muvzb.js";const E=({paiement_id:a=3,returnUrl:F="/paiements"})=>{var c,o;const[s,m]=t.useState(null),[h,u]=t.useState(!0),[d,f]=t.useState(null),i=t.useRef(null);t.useEffect(()=>{a&&(async()=>{var r,x;try{const n=await g.get(`/api/paiement/${a}`);m(n.data)}catch(n){f(((x=(r=n.response)==null?void 0:r.data)==null?void 0:x.message)||"Une erreur est survenue")}finally{u(!1)}})()},[a]);const j=()=>{const l=i.current;if(!l)return;const r={margin:.5,filename:`facture-${(s==null?void 0:s.numero_facture)||"undefined"}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};k().from(l).set(r).save()},b=()=>{window.print()};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-teal-500 border-t-transparent rounded-full animate-spin"}),e.jsx("h2",{className:"text-lg font-medium text-slate-600 dark:text-slate-300",children:"Chargement de la facture..."})]})}):d?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl p-8 max-w-md",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mb-6",children:e.jsx("svg",{className:"h-8 w-8 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-slate-800 dark:text-slate-200 mb-3",children:"Erreur"}),e.jsx("p",{className:"text-center text-slate-600 dark:text-slate-400 mb-6",children:d}),e.jsx("button",{onClick:()=>window.history.back(),className:"px-5 py-2.5 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors shadow-sm",children:"Retour"})]})})}):e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200",children:[e.jsx(w,{title:`Facture #${(s==null?void 0:s.numero_facture)||""} - Dargatech`}),e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center mb-4 md:mb-0",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"mr-4 p-2 rounded-full bg-white dark:bg-slate-800 shadow-sm hover:shadow-md transition-shadow no-print",children:e.jsx(p,{className:"h-5 w-5 text-slate-600 dark:text-slate-300"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Facture #",(s==null?void 0:s.numero_facture)||""]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Client: ",(c=s==null?void 0:s.client)==null?void 0:c.nom," ",(o=s==null?void 0:s.client)==null?void 0:o.prenom]})]})]}),e.jsxs("div",{className:"flex space-x-3 no-print",children:[e.jsxs("button",{onClick:b,className:"flex items-center px-4 py-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(N,{className:"h-4 w-4 mr-2 text-slate-600 dark:text-slate-300"}),e.jsx("span",{children:"Imprimer"})]}),e.jsxs("button",{onClick:j,className:"flex items-center px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors shadow-sm",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Télécharger PDF"})]})]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl overflow-hidden",children:e.jsx(y,{data:s,ref:i})}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-slate-200 dark:border-slate-700 text-sm text-slate-500 dark:text-slate-400 flex justify-between items-center no-print",children:[e.jsxs("div",{children:["Facture générée le ",new Date().toLocaleDateString("fr-FR")]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{children:"Dargatech Solutions Solaires"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-slate-400 mx-2"}),e.jsxs("span",{children:["Facture #ID: ",s==null?void 0:s.id]})]})]})]})]})};export{E as default};
