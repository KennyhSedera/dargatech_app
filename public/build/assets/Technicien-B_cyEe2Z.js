import{j as e,r as l,m as R,L as U}from"./app-BQyrTZVC.js";import{C as W}from"./ConfirmDialog-DABb_ZE0.js";import{E as z}from"./EmptyState-B9HpWti9.js";import{H as G}from"./HeaderPage-Durkh_Rg.js";import{S as J}from"./Snackbar-BVCqO3m-.js";import{x as I,F as K,v as Q,u as X,y as Y}from"./constant-NEMinriC.js";import{M as Z}from"./Modal-DxdL0X4M.js";import{I as y}from"./InputLabel-BY7gZKOc.js";import{T as N,I as f}from"./TextInput-Dh7SaJi6.js";import{f as _}from"./validateForm-CYV7VTEV.js";import{a as T}from"./api-DNr_UqCX.js";import{S as ee}from"./SelectInput-BkxtSpZk.js";import{A as te}from"./AuthenticatedLayout-BoTMMhs6.js";import"./index-Bva61L1C.js";import"./iconBase-C8Uyol4w.js";import"./transition-DyKxjau6.js";import"./index-D2NUHNAS.js";import"./useTheme-CPOaTzb7.js";import"./index-RbQYcc4a.js";const se=async()=>{try{return(await T.get("/technicien")).data}catch(s){throw console.error("Erreur lors de la récupération des techniciens",s),s}},ae=async s=>{try{return(await T.post("/technicien",s)).data}catch(c){throw console.error("Erreur lors de l'enregistrement du technicien",c),c}},re=async s=>{try{return(await T.delete(`/technicien/${s}`)).data}catch(c){throw console.error("Erreur lors de la suppression du technicien",c),c}},oe=({technician:s,onDelete:c,onView:w})=>{const u=["#6B7280","#4B5563","#374151","#1F2937","#111827","#6B7280"],p=u[s.id%u.length],n=s.name.charAt(0).toUpperCase();return e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex px-6 py-5 items-center mb-4 bg-gradient-to-br dark:from-blue-500 dark:to-purple-500 from-red-500 to-orange-500",children:[e.jsx("div",{className:"w-14 h-14 rounded-lg mr-4 overflow-hidden flex items-center border-2 border-gray-200 dark:border-gray-700 justify-center bg-gray-100 dark:bg-gray-700",children:s.photo?e.jsx("img",{src:s.photo,alt:s.name,className:"w-full h-full object-cover",onError:o=>{o.target.style.display="none",o.target.parentNode.style.backgroundColor=p,o.target.parentNode.innerHTML=n}}):e.jsx(I,{className:"text-gray-500 text-2xl"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-1",children:s.name}),e.jsx("p",{className:"text-gray-400 font-medium",children:s.speciality})]})]}),e.jsxs("div",{className:"space-y-3 px-6 pt-2 pb-5",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsx(K,{className:"text-gray-500 dark:text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 text-sm font-medium truncate",title:s.email,children:s.email})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsx(I,{className:"text-gray-500 dark:text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:s.genre})]}),e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsx(Q,{className:"text-gray-500 text-lg dark:text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:s.contact})]})]}),e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsx(X,{className:"text-gray-500 dark:text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:s.adress})]})]})]})})},ne=({open:s=!1,setOpen:c,onCloseFormulaire:w=()=>{}})=>{const[u,p]=l.useState("Enregistrer"),[n,o]=l.useState({}),[j,C]=l.useState(!1),{data:d,setData:r,errors:i,reset:b}=R({name:"",email:"",contact:"",password:"",adress:"",speciality:"",genre:"Homme",photo:""}),g=a=>{c(!1),v(),w(a)},v=()=>{b(),o({})},h=async()=>{if(_(d,o)){C(!0),p("Loading ..."),d.password=Y(8);try{let a;u==="Enregistrer"&&({message:a}=await ae(d)),g(a)}catch(a){console.error("Error submitting payment:",a)}finally{C(!1),p("Enregistrer")}}};return e.jsxs(Z,{show:s,closeable:!1,onClose:g,maxWidth:"xl",children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:"Nouveau Technicien"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"name",value:"Nom"}),e.jsx(N,{id:"name",name:"name",value:d.name,isFocused:!0,className:"block w-full mt-1",autoComplete:"name",onChange:a=>r("name",a.target.value),required:!0,onFocus:()=>o({...n,name:""})}),e.jsx(f,{message:n.name||i.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"email",value:"Email"}),e.jsx(N,{id:"email",name:"email",value:d.email,className:"block w-full mt-1",autoComplete:"email",onChange:a=>r("email",a.target.value),required:!0,onFocus:()=>o({...n,email:""})}),e.jsx(f,{message:n.email||i.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"genre",value:"Sexe"}),e.jsxs(ee,{id:"genre",type:"genre",name:"genre",value:d.genre,className:"block w-full mt-1",autoComplete:"genre",onChange:a=>r("genre",a.target.value),required:!0,children:[e.jsx("option",{value:"Homme",children:"Homme"}),e.jsx("option",{value:"Femme",children:"Femme"})]}),e.jsx(f,{message:i.genre,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"contact",value:"Contact"}),e.jsx(N,{id:"contact",name:"contact",value:d.contact,className:"block w-full mt-1",autoComplete:"contact",onChange:a=>r("contact",a.target.value),required:!0,onFocus:()=>o({...n,contact:""})}),e.jsx(f,{message:n.contact||i.contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"adress",value:"Adresse"}),e.jsx(N,{id:"adress",name:"adress",value:d.adress,className:"block w-full mt-1",autoComplete:"adress",onChange:a=>r("adress",a.target.value),required:!0,onFocus:()=>o({...n,adress:""})}),e.jsx(f,{message:n.adress||i.adress,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"speciality",value:"Spécialité"}),e.jsx(N,{id:"speciality",name:"speciality",value:d.speciality,className:"block w-full mt-1",autoComplete:"adress",onChange:a=>r("speciality",a.target.value),required:!0,onFocus:()=>o({...n,speciality:""})}),e.jsx(f,{message:n.speciality||i.speciality,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>g(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${j&&"opacity-25"}`,disabled:j,onClick:h,children:u})]})]})},Fe=()=>{const[s,c]=l.useState(""),[w,u]=l.useState(!1),[p,n]=l.useState([]),[o,j]=l.useState([]),[C,d]=l.useState(!0),[r,i]=l.useState(1),[b]=l.useState(8),[g,v]=l.useState({open:!1,message:"",id:0}),[h,a]=l.useState({open:!1,message:"",type:"success"}),S=async()=>{d(!0);const{data:t}=await se(),F=t.map(m=>({id:m.technicien.id,name:m.name,email:m.email,genre:m.technicien.genre,contact:m.technicien.contact,adress:m.technicien.adress,speciality:m.technicien.speciality,photo:m.technicien.photo}));n(F),j(F),d(!1)};l.useEffect(()=>{S()},[]);const M=t=>{c(t),i(1);const F=p.filter(m=>m.name.toLowerCase().includes(t.toLowerCase())||m.email.toLowerCase().includes(t.toLowerCase())||m.speciality.toLowerCase().includes(t.toLowerCase()));j(F)},$=t=>{S(),t&&a({...h,message:t,open:!0})},A=t=>{console.log("View details for ID:",t)},q=t=>{v({open:!0,message:`Êtes-vous sûr de vouloir supprimer le technicien ${t.name} ?`,id:t.id})},H=async()=>{const{message:t}=await re(g.id);a({...h,message:t,open:!0}),v({...g,open:!1,id:0}),S(),i(1)},P=r*b,B=P-b,V=o.slice(B,P),x=Math.ceil(o.length/b),D=[],E=5;let L=Math.max(1,r-Math.floor(E/2)),k=L+E-1;k>x&&(k=x,L=Math.max(1,k-E+1));for(let t=L;t<=k;t++)D.push(t);const O=o.length!==p.length?`(${o.length}/${p.length})`:"";return e.jsxs(te,{children:[e.jsx(U,{title:"Technicien"}),e.jsx(G,{handleClick:()=>u(!0),title:`Liste des Techniciens ${O}`,search:s,onSearch:M}),e.jsx(ne,{open:w,setOpen:u,onCloseFormulaire:$}),e.jsx(J,{message:h.message,type:h.type,duration:3e3,position:"top-right",show:h.open,onClose:()=>a({...h,message:"",open:!1})}),e.jsx(W,{open:g.open,message:g.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>v({...g,open:!1}),accept:H}),C?e.jsx("div",{className:"flex flex-col justify-center items-center h-64 rounded-xl p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500 mb-4"})}):e.jsx(e.Fragment,{children:o.length>0?e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:V.map(t=>e.jsx(oe,{technician:t,onDelete:q,onView:A},t.id))}),x>1&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center bg-white rounded-lg shadow-sm px-2 py-2 border border-gray-200",children:[e.jsx("button",{onClick:()=>i(1),disabled:r===1,className:`mx-1 p-2 rounded-md ${r===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Première page",children:"«"}),e.jsx("button",{onClick:()=>i(t=>Math.max(t-1,1)),disabled:r===1,className:`mx-1 p-2 rounded-md ${r===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page précédente",children:"‹"}),D.map(t=>e.jsx("button",{onClick:()=>i(t),className:`mx-1 w-9 h-9 flex items-center justify-center rounded-md ${r===t?"bg-indigo-600 text-white font-medium":"text-gray-700 hover:bg-indigo-50"}`,children:t},t)),e.jsx("button",{onClick:()=>i(t=>Math.min(t+1,x)),disabled:r===x,className:`mx-1 p-2 rounded-md ${r===x?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page suivante",children:"›"}),e.jsx("button",{onClick:()=>i(x),disabled:r===x,className:`mx-1 p-2 rounded-md ${r===x?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Dernière page",children:"»"})]})})]}):e.jsx(z,{nom:"technicien",search:s})})]})};export{Fe as default};
