import{m as F,r as t,j as e,d as P}from"./app-CmL8TdgT.js";import{C as I,D as T,G as L}from"./index-Cg7cYwVG.js";import{H as k}from"./HeaderPage-B52-G20L.js";import{u as A}from"./api-OGwnO7u9.js";import{T as E,I as _}from"./TextInput-1m94bHjT.js";import{I as C}from"./InputLabel-8KFd54Qy.js";import{S as D}from"./Snackbar-Blx3HZjz.js";import{I as R}from"./InputImage-DWVuyRHC.js";import{e as G}from"./validateForm-C-Be7ugn.js";import{n as H}from"./constant-wfS04Kwq.js";import{g as $,d as q}from"./TypePaiementService-D4FGJ9GI.js";import"./Modal-B5T3nMJo.js";import"./transition-CHtezwrT.js";import"./index-i6ARvHnj.js";import"./iconBase-DIw4c1F9.js";import"./index-CdlGWxea.js";const B=({reload:N=()=>{}})=>{const{data:o,setData:f,errors:m,reset:w}=F({name:"",logo_path:null}),[i,g]=t.useState({open:!1,message:"",type:"success"}),[r,c]=t.useState({}),y=t.useRef(null),[n,p]=t.useState("Ajouter"),[l,h]=t.useState(!1),v=async()=>{var j;if(!G(o,c))return;const a=new FormData;a.append("name",o.name),a.append("logo_path",o.logo_path),h(!0),p("Loading ...");try{const{data:u}=await P.post(`${A}/type_paiement`,a);g({open:!0,message:u.message,type:"success"})}catch(u){console.error("Erreur:",((j=u.response)==null?void 0:j.data)||u.message)}finally{d()}},S=a=>{f({...o,logo_path:a})},d=()=>{w(),p("Ajouter"),h(!1),c({}),N()};return e.jsxs("div",{className:"w-full p-4 mt-4 bg-white rounded-lg shadow-sm dark:bg-gray-800",children:[e.jsx(D,{message:i.message,type:i.type,duration:3e3,position:"top-right",show:i.open,onClose:()=>g({...i,message:"",open:!1})}),e.jsx("div",{className:"text-lg font-semibold text-center",children:"Nouveau"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"type_name",value:"Nom"}),e.jsx(E,{id:"type_name",isFocused:!0,name:"type_name",value:o.name,className:"block w-full mt-1",autoComplete:"type_name",onChange:a=>f("name",a.target.value),required:!0,placeholder:"Nom de la type",onFocus:()=>c({...r,name:""})}),e.jsx(_,{message:r.name||m.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"logo_path",value:"Logo"}),e.jsx(R,{ref:y,selectedFile:o.logo_path,onLoadFile:S,onFocus:()=>c({...r,logo_path:""})}),e.jsx(_,{message:r.logo_path||m.logo_path,className:"mt-2"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("button",{className:"w-auto px-4 py-1 mr-2 text-red-600 rounded-md bg-red-400/20 disabled:cursor-not-allowed",onClick:d,children:"Annuler"}),e.jsx("button",{disabled:l,className:"w-auto px-4 py-1 text-white bg-blue-500 rounded-md disabled:cursor-not-allowed disabled:opacity-10 ",onClick:v,children:n})]})]})},oe=()=>{const[N,o]=t.useState("");t.useState({});const[f,m]=t.useState(1),[w,i]=t.useState([]),[g,r]=t.useState([]),[c,y]=t.useState(!0),[n,p]=t.useState({open:!1,message:"",id:0}),[l,h]=t.useState({open:!1,message:"",type:"success"}),v=[{key:"id",label:"ID"},{key:"name",label:"Nom"},{key:"logo_path",label:"logo",customRender:s=>e.jsx("img",{src:s,alt:"logo type",className:"w-10 h-10 object-cover rounded-md"})}],S=[{label:e.jsx(L,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:s=>a(s)}],d=async()=>{y(!0);try{const{type:s}=await $(),b=s.map(x=>({id:x.id,name:x.name,logo_path:x.logo_path}));i(b),r(b)}catch(s){console.log(s)}finally{y(!1)}};t.useEffect(()=>{d()},[]);const a=s=>{p({open:!0,message:`Êtes-vous sûr de vouloir supprimer la type de paiement par ${s.name} ?`,id:s.id})},j=async()=>{const{message:s}=await q(n.id);h({...l,message:s,open:!0}),p({...n,open:!1,id:0}),d(),m(1)},u=s=>{o(s),m(1);const b=w.filter(x=>x.name.toString().toLowerCase().includes(s.toLowerCase()));r(b)};return e.jsxs("div",{children:[e.jsx(k,{search:N,onSearch:u,title:"Liste des types de paiement",btn:!1}),e.jsx(D,{message:l.message,type:l.type,duration:3e3,position:"top-right",show:l.open,onClose:()=>h({...l,message:"",open:!1})}),e.jsx(I,{open:n.open,message:n.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>p({...n,open:!1}),accept:j}),c?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx("div",{className:"sm:col-span-2",children:g.length>0?e.jsx(T,{headers:v,rows:g,itemsPerPage:10,actions:S,className:"mt-4",currentPage:f,onPageChange:m}):e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:H,alt:"no data",className:"max-w-md opacity-50 mt-2"})})}),e.jsx("div",{className:"sm:col-span-1",children:e.jsx(B,{reload:()=>d()})})]})]})};export{oe as default};
