import{r as a,j as t,$ as P,m as I}from"./app-CKIQC7bl.js";import{F as $}from"./FormulaireClient-f9qtoJ-S.js";import{C as R}from"./ConfirmDialog-DpPfg_rg.js";import{D as A}from"./DataTable-gPVHnAYW.js";import{E as M}from"./EmptyState-BuVt_WbL.js";import{H as G}from"./HeaderPage-Cu_PBayX.js";import{S as H}from"./Snackbar-BgpWpSLL.js";import{A as O,R as V}from"./AuthenticatedLayout-BmgAKyoc.js";import{b as W,d as q}from"./clientService-CgtVVlBX.js";import{j as z}from"./constant-Ccl-ng2K.js";import{G as B}from"./index-y2Q3NTKV.js";import{T as J,a as K}from"./index-D8MTw20h.js";import"./Modal-OJ7ZqoQe.js";import"./transition-De7C3uv9.js";import"./TextInput-CrJOgruW.js";import"./createLucideIcon-CKqiLiGq.js";import"./InputLabel-CLXF8NDZ.js";import"./validateForm-f9K0gDaZ.js";import"./SelectInput-D3RubUYM.js";import"./index-C37N_ndF.js";import"./iconBase-BrNMzGLU.js";import"./useTheme-CqPKuz4y.js";import"./api-DgjbNlyT.js";const Ce=()=>{const[d,C]=a.useState(""),[g,n]=a.useState(!1),[y,l]=a.useState(1),[u,j]=a.useState([]),[x,h]=a.useState([]),[w,b]=a.useState({}),[S,f]=a.useState(!0),[r,c]=a.useState({open:!1,message:"",id:0}),[o,m]=a.useState({open:!1,message:"",type:"success"}),p=async()=>{f(!0);const i=(await W()).clients.map(s=>({id:s.id,nom:s.nom,prenom:s.prenom,CIN:s.CIN,email:s.email,telephone:s.telephone,localisation:s.localisation,surface_cultivee:s.surface_cultivee,type_activite_agricole:s.type_activite_agricole,created_via:s.created_via,is_payed:s.is_payed}));j(i),h(i),f(!1)};a.useEffect(()=>{p()},[]);const N=e=>{C(e),l(1);const i=u.filter(s=>s.nom.toLowerCase().includes(e.toLowerCase())||s.prenom.toLowerCase().includes(e.toLowerCase())||s.telephone.toLowerCase().includes(e.toLowerCase())||s.surface_cultivee.toLowerCase().includes(e.toLowerCase())||s.type_activite_agricole.toLowerCase().includes(e.toLowerCase())||s.localisation.toLowerCase().includes(e.toLowerCase()));h(i)},L=()=>{n(!0)},_=[{key:"id",label:"ID",sortable:!0,customRender:e=>t.jsx("div",{className:"text-sm",children:t.jsx("span",{children:e})})},{key:"nom",label:"Nom",sortable:!0},{key:"prenom",label:"Prénom",sortable:!0},{key:"CIN",label:"CIN"},{key:"email",label:"Email",sortable:!0},{key:"telephone",label:"Téléphone"},{key:"localisation",label:"Localisation",sortable:!0},{key:"type_activite_agricole",label:"Type d'activité agricole"},{key:"is_payed",label:"Statut",customRender:e=>t.jsx("span",{className:`text-sm font-medium ${e?"text-green-500":"text-red-500"}`,children:e?"Payé":"Non payé"})},{key:"created_via",label:"Via",customRender:e=>t.jsx("span",{className:"text-xl font-medium text-gray-900 dark:text-white",children:e==="web"?t.jsx(K,{}):t.jsx(V,{className:"text-blue-400"})})}],v=[{label:t.jsx(z,{className:"text-base"}),color:"text-green-500",hoverColor:"text-green-600",handler:e=>F(e.id)},{label:t.jsx(J,{className:"text-lg"}),color:"text-blue-500",hoverColor:"text-blue-600",handler:e=>D(e)},{label:t.jsx(B,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:e=>T(e)}],k=e=>{p(),e&&m({...o,message:e,open:!0}),b({})},D=e=>{b(e),n(!0)},T=e=>{c({open:!0,message:`Êtes-vous sûr de vouloir supprimer ${e.nom} ${e.prenom}?`,id:e.id})},E=async()=>{const{message:e}=await q(r.id);m({...o,message:e,open:!0}),c({...r,open:!1,id:0}),p(),l(1)},F=async e=>{I.visit(`/client/${e}`)};return t.jsxs(O,{children:[t.jsx(P,{title:"Maraîchers"}),t.jsx(G,{title:`Liste des Maraîchers ( Total: ${u.length} )`,handleClick:L,onSearch:N,search:d}),t.jsx($,{setOpen:n,open:g,dataModify:w,onCloseFormulaire:k}),t.jsx(H,{message:o.message,type:o.type,duration:3e3,position:"top-right",show:o.open,onClose:()=>m({...o,message:"",open:!1})}),t.jsx(R,{open:r.open,message:r.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>c({...r,open:!1}),accept:E}),S?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"w-12 h-12 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):t.jsx("div",{children:x.length>0?t.jsx(A,{headers:_,rows:x,itemsPerPage:10,actions:v,className:"mt-4",currentPage:y,onPageChange:l}):t.jsx(M,{nom:"maraîcher",search:d})})]})};export{Ce as default};
