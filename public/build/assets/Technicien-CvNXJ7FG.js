import{j as e,r as m,v as J,$ as z}from"./app-DvL3bIJz.js";import{C as K}from"./index-BKdiEWeE.js";import{E as Q}from"./EmptyState--prdr00H.js";import{H as X}from"./HeaderPage-B1SenMgH.js";import{S as Y}from"./Snackbar-5R3LguWu.js";import{E as H,i as Z,B as ee,G as se,J as te}from"./constant-BOdoBgxy.js";import{M as ae}from"./Modal-BWXXYoCo.js";import{I as y}from"./InputLabel-CXUPufFi.js";import{T as f,I as j}from"./TextInput-D7DGX3i1.js";import{c as re}from"./validateForm-DkOh89YH.js";import{a as E}from"./api-CsiuXi1e.js";import{S as oe}from"./SelectInput-CjwIBOb3.js";import{A as ne}from"./AuthenticatedLayout-0FTk_4H1.js";import"./iconBase-uHazxSoj.js";import"./transition-CAmvPYwg.js";import"./createLucideIcon-CRCc9vS4.js";import"./useTheme-DR6rf2ta.js";import"./index-CyQftCib.js";const ie=({technician:a,onDelete:d,onView:w})=>{const x=["#6B7280","#4B5563","#374151","#1F2937","#111827","#6B7280"],h=x[a.id%x.length],n=a.name.charAt(0).toUpperCase();return e.jsx("div",{className:"overflow-hidden transition-all duration-300 transform bg-white border border-gray-200 shadow-md dark:bg-gray-800 rounded-xl hover:shadow-lg hover:-translate-y-1 dark:border-gray-700",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex items-center px-6 py-5 mb-4 bg-gradient-to-br dark:from-blue-500 dark:to-purple-500 from-red-500 to-orange-500",children:[e.jsx("div",{className:"flex items-center justify-center mr-4 overflow-hidden bg-gray-100 border-2 border-gray-200 rounded-lg w-14 h-14 dark:border-gray-700 dark:bg-gray-700",children:a.photo?e.jsx("img",{src:a.photo,alt:a.name,className:"object-cover w-full h-full",onError:i=>{i.target.style.display="none",i.target.parentNode.style.backgroundColor=h,i.target.parentNode.innerHTML=n}}):e.jsx(H,{className:"text-2xl text-gray-500"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"mb-1 text-xl font-bold text-gray-100",children:a.name}),e.jsx("p",{className:"font-medium text-gray-200",children:a.speciality})]})]}),e.jsxs("div",{className:"px-6 pt-2 pb-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(Z,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 truncate dark:text-gray-300",title:a.email,children:a.email})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(H,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.genre})]}),e.jsx("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:e.jsx("span",{className:"text-sm text-gray-700 truncate dark:text-gray-300",children:a.contact})})]}),e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(ee,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.adress})]}),a.telegram_username&&e.jsxs("div",{className:"relative flex items-center px-3 py-2 bg-gray-100 rounded-lg dark:bg-gray-700",children:[e.jsx(se,{className:"mr-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.telegram_username}),e.jsx("span",{className:"absolute right-2",children:a.bot_active?"âœ…":"ðŸš«"})]})]})]})})},le=async()=>{try{return(await E.get("/technicien")).data}catch(a){throw console.error("Erreur lors de la rÃ©cupÃ©ration des techniciens",a),a}},ce=async a=>{try{return(await E.post("/technicien",a)).data}catch(d){throw console.error("Erreur lors de l'enregistrement du technicien",d),d}},me=async a=>{try{return(await E.delete(`/technicien/${a}`)).data}catch(d){throw console.error("Erreur lors de la suppression du technicien",d),d}},de=({open:a=!1,setOpen:d,onCloseFormulaire:w=()=>{}})=>{const[x,h]=m.useState("Enregistrer"),[n,i]=m.useState({}),[b,C]=m.useState(!1),{data:c,setData:o,errors:l,reset:v}=J({name:"",email:"",contact:"",password:"",adress:"",speciality:"",genre:"Homme",photo:"",telegram_username:""}),g=r=>{d(!1),N(),w(r)},N=()=>{v(),i({})},p=async()=>{if(re(c,i)){C(!0),h("Loading ..."),c.password=te(8);try{let r;x==="Enregistrer"&&({message:r}=await ce(c)),g(r)}catch(r){console.error("Error submitting payment:",r)}finally{C(!1),h("Enregistrer")}}};return e.jsxs(ae,{show:a,closeable:!1,onClose:g,maxWidth:"4xl",children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:"Nouveau Technicien"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"name",value:"Nom"}),e.jsx(f,{id:"name",name:"name",value:c.name,isFocused:!0,className:"block w-full mt-1",autoComplete:"name",onChange:r=>o("name",r.target.value),required:!0,onFocus:()=>i({...n,name:""})}),e.jsx(j,{message:n.name||l.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"email",value:"Email"}),e.jsx(f,{id:"email",name:"email",value:c.email,className:"block w-full mt-1",autoComplete:"email",onChange:r=>o("email",r.target.value),required:!0,onFocus:()=>i({...n,email:""})}),e.jsx(j,{message:n.email||l.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"genre",value:"Sexe"}),e.jsxs(oe,{id:"genre",type:"genre",name:"genre",value:c.genre,className:"block w-full mt-1",autoComplete:"genre",onChange:r=>o("genre",r.target.value),required:!0,children:[e.jsx("option",{value:"Homme",children:"Homme"}),e.jsx("option",{value:"Femme",children:"Femme"})]}),e.jsx(j,{message:l.genre,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"contact",value:"Contact"}),e.jsx(f,{id:"contact",name:"contact",value:c.contact,className:"block w-full mt-1",autoComplete:"contact",onChange:r=>o("contact",r.target.value),required:!0,onFocus:()=>i({...n,contact:""})}),e.jsx(j,{message:n.contact||l.contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"adress",value:"Adresse"}),e.jsx(f,{id:"adress",name:"adress",value:c.adress,className:"block w-full mt-1",autoComplete:"adress",onChange:r=>o("adress",r.target.value),required:!0,onFocus:()=>i({...n,adress:""})}),e.jsx(j,{message:n.adress||l.adress,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"speciality",value:"SpÃ©cialitÃ©"}),e.jsx(f,{id:"speciality",name:"speciality",value:c.speciality,className:"block w-full mt-1",autoComplete:"adress",onChange:r=>o("speciality",r.target.value),required:!0,onFocus:()=>i({...n,speciality:""})}),e.jsx(j,{message:n.speciality||l.speciality,className:"mt-2"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(y,{htmlFor:"telegram_username",value:"Pseudo sur telegram"}),e.jsx(f,{id:"telegram_username",name:"telegram_username",value:c.telegram_username,className:"block w-full mt-1",autoComplete:"telegram_username",onChange:r=>o("telegram_username",r.target.value),required:!0,onFocus:()=>i({...n,telegram_username:""})}),e.jsx(j,{message:n.telegram_username||l.telegram_username,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>g(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${b&&"opacity-25"}`,disabled:b,onClick:p,children:x})]})]})},Ee=()=>{const[a,d]=m.useState(""),[w,x]=m.useState(!1),[h,n]=m.useState([]),[i,b]=m.useState([]),[C,c]=m.useState(!0),[o,l]=m.useState(1),[v]=m.useState(8),[g,N]=m.useState({open:!1,message:"",id:0}),[p,r]=m.useState({open:!1,message:"",type:"success"}),S=async()=>{c(!0);const{data:s}=await le(),F=s.map(t=>({id:t.technicien.id,name:t.name,email:t.email,genre:t.technicien.genre,contact:t.technicien.contact,adress:t.technicien.adress,speciality:t.technicien.speciality,photo:t.technicien.photo,telegram_username:t.technicien.telegram_username,bot_active:t.technicien.bot_active}));n(F),b(F),c(!1)};m.useEffect(()=>{S()},[]);const B=s=>{d(s),l(1);const F=h.filter(t=>{var D,I,M,$,A,q;return((D=t==null?void 0:t.name)==null?void 0:D.toLowerCase().includes(s.toLowerCase()))||((I=t==null?void 0:t.email)==null?void 0:I.toLowerCase().includes(s.toLowerCase()))||((M=t==null?void 0:t.speciality)==null?void 0:M.toLowerCase().includes(s.toLowerCase()))||(($=t==null?void 0:t.contact)==null?void 0:$.toString().toLowerCase().includes(s.toLowerCase()))||((A=t==null?void 0:t.telegram_username)==null?void 0:A.toLowerCase().includes(s.toLowerCase()))||((q=t==null?void 0:t.adress)==null?void 0:q.toLowerCase().includes(s.toLowerCase()))});b(F)},V=s=>{S(),s&&r({...p,message:s,open:!0})},O=s=>{console.log("View details for ID:",s)},R=s=>{N({open:!0,message:`ÃŠtes-vous sÃ»r de vouloir supprimer le technicien ${s.name} ?`,id:s.id})},U=async()=>{const{message:s}=await me(g.id);r({...p,message:s,open:!0}),N({...g,open:!1,id:0}),S(),l(1)},_=o*v,W=_-v,G=i.slice(W,_),u=Math.ceil(i.length/v),P=[],L=5;let T=Math.max(1,o-Math.floor(L/2)),k=T+L-1;k>u&&(k=u,T=Math.max(1,k-L+1));for(let s=T;s<=k;s++)P.push(s);return e.jsxs(ne,{children:[e.jsx(z,{title:"Technicien"}),e.jsx(X,{handleClick:()=>x(!0),title:`Liste des Techniciens ( Total: ${h.length} )`,search:a,onSearch:B}),e.jsx(de,{open:w,setOpen:x,onCloseFormulaire:V}),e.jsx(Y,{message:p.message,type:p.type,duration:3e3,position:"top-right",show:p.open,onClose:()=>r({...p,message:"",open:!1})}),e.jsx(K,{open:g.open,message:g.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>N({...g,open:!1}),accept:U}),C?e.jsx("div",{className:"flex flex-col items-center justify-center h-64 p-8 rounded-xl",children:e.jsx("div",{className:"w-12 h-12 mb-4 border-t-2 border-b-2 border-indigo-500 rounded-full animate-spin"})}):e.jsx(e.Fragment,{children:i.length>0?e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:G.map(s=>e.jsx(ie,{technician:s,onDelete:R,onView:O},s.id))}),u>1&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center px-2 py-2 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>l(1),disabled:o===1,className:`mx-1 p-2 rounded-md ${o===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"PremiÃ¨re page",children:"Â«"}),e.jsx("button",{onClick:()=>l(s=>Math.max(s-1,1)),disabled:o===1,className:`mx-1 p-2 rounded-md ${o===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page prÃ©cÃ©dente",children:"â€¹"}),P.map(s=>e.jsx("button",{onClick:()=>l(s),className:`mx-1 w-9 h-9 flex items-center justify-center rounded-md ${o===s?"bg-indigo-600 text-white font-medium":"text-gray-700 hover:bg-indigo-50"}`,children:s},s)),e.jsx("button",{onClick:()=>l(s=>Math.min(s+1,u)),disabled:o===u,className:`mx-1 p-2 rounded-md ${o===u?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"Page suivante",children:"â€º"}),e.jsx("button",{onClick:()=>l(u),disabled:o===u,className:`mx-1 p-2 rounded-md ${o===u?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-indigo-50"}`,title:"DerniÃ¨re page",children:"Â»"})]})})]}):e.jsx(Q,{nom:"technicien",search:a})})]})};export{Ee as default};
