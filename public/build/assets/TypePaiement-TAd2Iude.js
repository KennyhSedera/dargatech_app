import{m as F,r as t,j as e,d as P}from"./app-BDvQqi8O.js";import{C as I}from"./ConfirmDialog-KzKBN7n8.js";import{D as T,G as E}from"./index-DMRp7dzX.js";import{H as L}from"./HeaderPage-w1fcFvT7.js";import{u as k}from"./api-B2KTsAU8.js";import{T as A,I as _}from"./TextInput-D_lpO4jm.js";import{I as C}from"./InputLabel-BbG62oRH.js";import{S as D}from"./Snackbar-BRongGB3.js";import{I as R}from"./InputImage-NjIOO5GZ.js";import{e as G}from"./validateForm-CYcmU5RH.js";import{g as H,d as $}from"./TypePaiementService-OVT0Ov7S.js";import{E as q}from"./EmptyState-C14-jZH1.js";import"./Modal-DPvxb8TU.js";import"./transition-BzRYlxNR.js";import"./iconBase-Cmx0-DVi.js";import"./constant-DTp0l4TC.js";import"./index-CfUTnf5Z.js";const B=({reload:x=()=>{}})=>{const{data:o,setData:y,errors:m,reset:N}=F({name:"",logo_path:null}),[i,g]=t.useState({open:!1,message:"",type:"success"}),[r,p]=t.useState({}),b=t.useRef(null),[n,c]=t.useState("Ajouter"),[l,h]=t.useState(!1),v=async()=>{var j;if(!G(o,p))return;const a=new FormData;a.append("name",o.name),a.append("logo_path",o.logo_path),h(!0),c("Loading ...");try{const{data:u}=await P.post(`${k}/type_paiement`,a);g({open:!0,message:u.message,type:"success"})}catch(u){console.error("Erreur:",((j=u.response)==null?void 0:j.data)||u.message)}finally{d()}},S=a=>{y({...o,logo_path:a})},d=()=>{N(),c("Ajouter"),h(!1),p({}),x()};return e.jsxs("div",{className:"w-full p-4 mt-4 bg-white rounded-lg shadow-sm dark:bg-gray-800",children:[e.jsx(D,{message:i.message,type:i.type,duration:3e3,position:"top-right",show:i.open,onClose:()=>g({...i,message:"",open:!1})}),e.jsx("div",{className:"text-lg font-semibold text-center",children:"Nouveau"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"type_name",value:"Nom"}),e.jsx(A,{id:"type_name",isFocused:!0,name:"type_name",value:o.name,className:"block w-full mt-1",autoComplete:"type_name",onChange:a=>y("name",a.target.value),required:!0,placeholder:"Nom de la type",onFocus:()=>p({...r,name:""})}),e.jsx(_,{message:r.name||m.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"logo_path",value:"Logo"}),e.jsx(R,{ref:b,selectedFile:o.logo_path,onLoadFile:S,onFocus:()=>p({...r,logo_path:""})}),e.jsx(_,{message:r.logo_path||m.logo_path,className:"mt-2"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("button",{className:"w-auto px-4 py-1 mr-2 text-red-600 rounded-md bg-red-400/20 disabled:cursor-not-allowed",onClick:d,children:"Annuler"}),e.jsx("button",{disabled:l,className:"w-auto px-4 py-1 text-white bg-blue-500 rounded-md disabled:cursor-not-allowed disabled:opacity-10 ",onClick:v,children:n})]})]})},re=()=>{const[x,o]=t.useState("");t.useState({});const[y,m]=t.useState(1),[N,i]=t.useState([]),[g,r]=t.useState([]),[p,b]=t.useState(!0),[n,c]=t.useState({open:!1,message:"",id:0}),[l,h]=t.useState({open:!1,message:"",type:"success"}),v=[{key:"id",label:"ID"},{key:"name",label:"Nom"},{key:"logo_path",label:"logo",customRender:s=>e.jsx("img",{src:s,alt:"logo type",className:"w-10 h-10 object-cover rounded-md"})}],S=[{label:e.jsx(E,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:s=>a(s)}],d=async()=>{b(!0);try{const{type:s}=await H(),w=s.map(f=>({id:f.id,name:f.name,logo_path:f.logo_path}));i(w),r(w)}catch(s){console.log(s)}finally{b(!1)}};t.useEffect(()=>{d()},[]);const a=s=>{c({open:!0,message:`Êtes-vous sûr de vouloir supprimer la type de paiement par ${s.name} ?`,id:s.id})},j=async()=>{const{message:s}=await $(n.id);h({...l,message:s,open:!0}),c({...n,open:!1,id:0}),d(),m(1)},u=s=>{o(s),m(1);const w=N.filter(f=>f.name.toString().toLowerCase().includes(s.toLowerCase()));r(w)};return e.jsxs("div",{children:[e.jsx(L,{search:x,onSearch:u,title:"Liste des types de paiement",btn:!1}),e.jsx(D,{message:l.message,type:l.type,duration:3e3,position:"top-right",show:l.open,onClose:()=>h({...l,message:"",open:!1})}),e.jsx(I,{open:n.open,message:n.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>c({...n,open:!1}),accept:j}),p?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx("div",{className:"sm:col-span-2",children:g.length>0?e.jsx(T,{headers:v,rows:g,itemsPerPage:10,actions:S,className:"mt-4",currentPage:y,onPageChange:m}):e.jsx(q,{nom:"type de paiement",search:x})}),e.jsx("div",{className:"sm:col-span-1",children:e.jsx(B,{reload:()=>d()})})]})]})};export{re as default};
