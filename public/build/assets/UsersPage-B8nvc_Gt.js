import{j as e,r as d,v as R,e as W,$ as G}from"./app-FyKSqb4X.js";import{A as J}from"./AuthenticatedLayout-TMnnv5uF.js";import{g as K,d as Q}from"./userService-_OXkGHTG.js";import{H as X}from"./HeaderPage-COd7MIeF.js";import{S as Y}from"./Snackbar-Dk9YSniP.js";import{C as Z}from"./index-BmGzQ0GM.js";import{B as ee,S as ae,i as te,D as se,C as re}from"./constant-BpKtvTsE.js";import{E as oe}from"./EmptyState-BdoEIPfV.js";import{M as le}from"./Modal-BVataevS.js";import{I as v}from"./InputLabel-CEYvhR1b.js";import{T as y,I as w}from"./TextInput-0jDHmmwh.js";import"./transition-C6r3Hpr2.js";import"./iconBase-DXDW4Ccp.js";import"./useTheme-DnpHhRt3.js";import"./index-BZ-kzIvo.js";import"./createLucideIcon-pGVkgk15.js";import"./api-C2alDz8v.js";const ne=({user:r,handleDelete:b,handleImageError:o})=>{var l,f,p,i,m,n,g,c,x,j,u,s;return e.jsxs("div",{className:"overflow-hidden transition-all duration-300 transform bg-white shadow-lg dark:bg-gray-800 rounded-xl hover:scale-105 hover:shadow-xl",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 dark:from-indigo-600 dark:via-purple-600 dark:to-blue-700 opacity-90"}),e.jsxs("div",{className:"relative flex items-start justify-between px-6 pt-4 pb-14",children:[e.jsx("h3",{className:"text-xl font-bold text-white truncate",children:r.name}),e.jsx("div",{className:"relative",children:r.id!==1&&e.jsx("button",{onClick:()=>b(r.id),className:"p-2 text-white transition-colors rounded-full hover:bg-red-50 dark:hover:bg-gray-700",children:e.jsx(ee,{})})})]}),e.jsx("div",{className:"absolute -bottom-12 left-6",children:e.jsx("div",{className:"w-24 h-24 overflow-hidden border-4 border-white shadow-md rounded-xl dark:border-gray-800",children:(l=r.profile)!=null&&l.photo||(f=r.technicien)!=null&&f.photo||(p=r.partenaire)!=null&&p.logo?e.jsx("img",{src:((i=r.profile)==null?void 0:i.photo)||((m=r.technicien)==null?void 0:m.photo)||((n=r.partenaire)==null?void 0:n.logo),alt:`${r.name}'s profile`,className:"object-cover w-full h-full bg-gray-100 dark:bg-gray-900",onError:o}):e.jsx("div",{className:"flex items-center justify-center w-full h-full bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-700 dark:to-gray-600",children:e.jsx(ae,{className:"text-4xl text-gray-400 dark:text-gray-300"})})})})]}),e.jsxs("div",{className:"px-6 pb-6 pt-14",children:[e.jsx("div",{className:"mt-2 mb-4",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium text-white rounded-full bg-gradient-to-r from-green-400 to-blue-500",children:r.user_role.name})}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(te,{className:"mr-2 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:r.email})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(se,{className:"mr-2 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((g=r.technicien)==null?void 0:g.contact)||((c=r.profile)==null?void 0:c.contact)||((x=r.partenaire)==null?void 0:x.telephone)})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(re,{className:"mr-2 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((j=r.technicien)==null?void 0:j.adress)||((u=r.profile)==null?void 0:u.adress)||((s=r.partenaire)==null?void 0:s.adresse)})]})]})]})]},r.id)},ie=({open:r,closeForm:b})=>{const[o,l]=d.useState({}),[f,p]=d.useState(!1),{data:i,setData:m,errors:n,reset:g}=R({name:"",email:"",contact:"",adress:"",telegram_username:""}),c=s=>{b(s),x()},x=()=>{g(),l({}),p(!1)},j=(s,N)=>{const h={};return s.name||(h.name="Le nom est obligatoire"),s.email||(h.email="L'email est obligatoire"),s.contact||(h.contact="Le contact est obligatoire"),s.adress||(h.adress="L'adresse est obligatoire"),N(h),Object.keys(h).length===0},u=()=>{j(i,l)&&(p(!0),W.post("create/admin",i).then(s=>{p(!1),c(s.data.message)}).catch(s=>{p(!1),s.response&&s.response.data&&l(s.response.data.errors||{})}))};return e.jsxs(le,{show:r,maxWidth:"xl",onClose:()=>c(""),closeable:!1,children:[e.jsx("div",{className:"text-2xl font-semibold text-center",children:"Créer un Administrateur"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-4 my-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"name",value:"Nom"}),e.jsx(y,{id:"name",name:"name",value:i.name,className:"block w-full mt-1",autoComplete:"name",isFocused:!0,onChange:s=>m("name",s.target.value),required:!0,onFocus:()=>l({...o,name:""})}),e.jsx(w,{message:o.name||n.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"email",value:"Email"}),e.jsx(y,{id:"email",name:"email",value:i.email,className:"block w-full mt-1",autoComplete:"email",onChange:s=>m("email",s.target.value),required:!0,onFocus:()=>l({...o,email:""})}),e.jsx(w,{message:o.email||n.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"contact",value:"Contact"}),e.jsx(y,{id:"contact",name:"contact",value:i.contact,className:"block w-full mt-1",autoComplete:"contact",type:"number",onChange:s=>m("contact",s.target.value),required:!0,onFocus:()=>l({...o,contact:""})}),e.jsx(w,{message:o.contact||n.contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"adress",value:"adress"}),e.jsx(y,{id:"adress",name:"adress",value:i.adress,className:"block w-full mt-1",autoComplete:"adress",onChange:s=>m("adress",s.target.value),required:!0,onFocus:()=>l({...o,adress:""})}),e.jsx(w,{message:o.adress||n.adress,className:"mt-2"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(v,{htmlFor:"telegram_username",value:"Pseudo sur telegram"}),e.jsx(y,{id:"telegram_username",name:"telegram_username",value:i.telegram_username,className:"block w-full mt-1",autoComplete:"telegram_username",onChange:s=>m("telegram_username",s.target.value),required:!0,onFocus:()=>l({...o,telegram_username:""})}),e.jsx(w,{message:o.telegram_username||n.telegram_username,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 px-1",children:[e.jsx("button",{type:"button",className:"px-4 py-1 text-red-500 rounded-md bg-red-400/10",onClick:()=>c(""),children:"Fermer"}),e.jsx("button",{type:"submit",className:`disabled:cursor-not-allowed rounded-md py-1 px-4 bg-blue-500 text-white ${f&&"opacity-25"}`,disabled:f,onClick:u,children:"Enregistrer"})]})]})},ke=()=>{const[r,b]=d.useState([]),[o,l]=d.useState([]),[f,p]=d.useState(!0),[i,m]=d.useState(""),[n,g]=d.useState({open:!1,message:"",id:0}),[c,x]=d.useState({open:!1,message:"",type:"success"}),[j,u]=d.useState(!1),s=async()=>{try{const a=await K();b(a),l(a)}catch(a){console.error("Failed to fetch users:",a)}finally{p(!1)}};d.useEffect(()=>{s()},[]);const N=a=>{m(a);const O=r.filter(t=>{var C,L,k,F,S,E,_,U,A,I,D,q,M,P,$,T,H;return((C=t==null?void 0:t.name)==null?void 0:C.toLowerCase().includes(a.toLowerCase()))||((L=t==null?void 0:t.email)==null?void 0:L.toLowerCase().includes(a.toLowerCase()))||((F=(k=t==null?void 0:t.technicien)==null?void 0:k.contact)==null?void 0:F.toLowerCase().includes(a.toLowerCase()))||((E=(S=t==null?void 0:t.technicien)==null?void 0:S.adress)==null?void 0:E.toLowerCase().includes(a.toLowerCase()))||((_=t==null?void 0:t.user_role.name)==null?void 0:_.toLowerCase().includes(a.toLowerCase()))||((A=(U=t==null?void 0:t.profile)==null?void 0:U.adress)==null?void 0:A.toLowerCase().includes(a.toLowerCase()))||((D=(I=t==null?void 0:t.profile)==null?void 0:I.contact)==null?void 0:D.toLowerCase().includes(a.toLowerCase()))||((M=(q=t==null?void 0:t.partenaire)==null?void 0:q.telephone)==null?void 0:M.toLowerCase().includes(a.toLowerCase()))||(($=(P=t==null?void 0:t.partenaire)==null?void 0:P.adresse)==null?void 0:$.toLowerCase().includes(a.toLowerCase()))||((H=(T=t==null?void 0:t.partenaire)==null?void 0:T.site_web)==null?void 0:H.toLowerCase().includes(a.toLowerCase()))});l(O)},h=a=>{a&&x({open:!0,message:a,type:"success"}),u(!1),s()},V=a=>{a.target.onerror=null,a.target.src="/path/to/default-avatar.png"},z=a=>{g({open:!0,message:"Voulez-vous vraiment supprimer cet utilisateur ?",id:a})},B=async()=>{const a=await Q(n.id);a.success?(x({...c,open:!0,message:"Utilisateur supprimé avec succès",type:"success"}),g({...n,open:!1}),s()):x({...c,open:!0,message:a.message,type:"error"})};return e.jsxs(J,{children:[e.jsx(G,{title:"Users"}),e.jsx(X,{title:"Liste des utilisateurs",onSearch:N,search:i,handleClick:()=>u(!0)}),e.jsx(Z,{open:n.open,message:n.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",accept:B,close:()=>g({...n,open:!1,id:0})}),e.jsx(ie,{closeForm:h,open:j}),e.jsx(Y,{message:c.message,type:c.type,duration:3e3,position:"top-right",show:c.open,onClose:()=>x({...c,message:"",open:!1})}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:f?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):o.length===0?e.jsx(oe,{nom:"utilisateur",search:i}):e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:o.map(a=>e.jsx(ne,{user:a,handleDelete:z,handleImageError:V},a.id))})})})]})};export{ke as default};
