import{r as a,j as s,$ as O,m as V}from"./app-iLpEwkFE.js";import{F as W}from"./FormulaireClient-CXX1jX9d.js";import{C as q}from"./index-VLbxm6C9.js";import{D as z}from"./DataTable-DH3c8uz4.js";import{E as B}from"./EmptyState-CM1m2HA3.js";import{H as J}from"./HeaderPage-DfRnY2il.js";import{S as K}from"./Snackbar-CY9N2LfE.js";import{A as Q,R as U}from"./AuthenticatedLayout-BwgVHdNq.js";import{b as X,d as Y}from"./clientService-OqIqbTdk.js";import{m as Z}from"./constant-BgFCFUCF.js";import{G as ee}from"./index-B_3h_27a.js";import{a as te,T as se}from"./index-C_4JeSbH.js";import"./Modal-4V3eJG4x.js";import"./transition-C85lnkrZ.js";import"./TextInput-DSWbS6xe.js";import"./createLucideIcon-CYTHOCOn.js";import"./InputLabel-CFdbrHUl.js";import"./validateForm-DkOh89YH.js";import"./SelectInput-DFY1tehG.js";import"./iconBase-C3RcoVJT.js";import"./useTheme-BQMwaHer.js";import"./api-Cpp2W4Gc.js";const Le=()=>{const[d,N]=a.useState(""),[L,n]=a.useState(!1),[_,c]=a.useState(1),[u,v]=a.useState([]),[x,h]=a.useState([]),[k,g]=a.useState({}),[P,b]=a.useState(!0),[r,l]=a.useState({open:!1,message:"",id:0}),[o,m]=a.useState({open:!1,message:"",type:"success"}),[D,T]=a.useState(10),p=async()=>{b(!0);const i=(await X()).clients.map(t=>({id:t.id,nom:t.nom,prenom:t.prenom,CIN:t.CIN,email:t.email,telephone:t.telephone,localisation:t.localisation,surface_cultivee:t.surface_cultivee,type_activite_agricole:t.type_activite_agricole,created_via:t.created_via,is_payed:t.is_payed}));v(i),h(i),b(!1)};a.useEffect(()=>{p()},[]);const E=e=>{N(e),c(1);const i=u.filter(t=>{var f,C,y,j,w,S;return((f=t==null?void 0:t.nom)==null?void 0:f.toLowerCase().includes(e.toLowerCase()))||((C=t==null?void 0:t.prenom)==null?void 0:C.toLowerCase().includes(e.toLowerCase()))||((y=t==null?void 0:t.telephone)==null?void 0:y.toLowerCase().includes(e.toLowerCase()))||((j=t==null?void 0:t.surface_cultivee)==null?void 0:j.toString().toLowerCase().includes(e.toLowerCase()))||((w=t==null?void 0:t.type_activite_agricole)==null?void 0:w.toLowerCase().includes(e.toLowerCase()))||((S=t==null?void 0:t.localisation)==null?void 0:S.toLowerCase().includes(e.toLowerCase()))});h(i)},F=()=>{n(!0)},I=[{key:"id",label:"ID",sortable:!0,customRender:e=>s.jsx("div",{className:"text-sm",children:s.jsx("span",{children:e})})},{key:"nom",label:"Nom",sortable:!0},{key:"prenom",label:"Prénom",sortable:!0},{key:"CIN",label:"CIN"},{key:"email",label:"Email",sortable:!0},{key:"telephone",label:"Téléphone"},{key:"localisation",label:"Localisation",sortable:!0},{key:"type_activite_agricole",label:"Type d'activité agricole"},{key:"is_payed",label:"Statut",customRender:e=>s.jsx("span",{className:`text-sm font-medium ${e?"text-green-500":"text-red-500"}`,children:e?"Payé":"Non payé"})},{key:"created_via",label:"Via",customRender:e=>s.jsx("span",{className:"text-xl font-medium text-gray-900 dark:text-white",children:e==="web"?s.jsx(se,{}):s.jsx(U,{className:"text-blue-400"})})}],$=[{label:s.jsx(Z,{className:"text-base"}),color:"text-green-500",hoverColor:"text-green-600",handler:e=>H(e.id)},{label:s.jsx(te,{className:"text-lg"}),color:"text-blue-500",hoverColor:"text-blue-600",handler:e=>A(e)},{label:s.jsx(ee,{className:"text-base"}),color:"text-red-500",hoverColor:"text-red-600",handler:e=>M(e)}],R=e=>{p(),e&&m({...o,message:e,open:!0}),g({})},A=e=>{g(e),n(!0)},M=e=>{l({open:!0,message:`Êtes-vous sûr de vouloir supprimer ${e.nom} ${e.prenom}?`,id:e.id})},G=async()=>{const{message:e}=await Y(r.id);m({...o,message:e,open:!0}),l({...r,open:!1,id:0}),p(),c(1)},H=async e=>{V.visit(`/client/${e}`)};return s.jsxs(Q,{children:[s.jsx(O,{title:"Maraîchers"}),s.jsx(J,{title:`Liste des Maraîchers ( Total: ${u.length} )`,handleClick:F,onSearch:E,search:d}),s.jsx(W,{setOpen:n,open:L,dataModify:k,onCloseFormulaire:R}),s.jsx(K,{message:o.message,type:o.type,duration:3e3,position:"top-right",show:o.open,onClose:()=>m({...o,message:"",open:!1})}),s.jsx(q,{open:r.open,message:r.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>l({...r,open:!1}),accept:G}),P?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"w-12 h-12 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):s.jsx("div",{children:x.length>0?s.jsx(z,{headers:I,rows:x,itemsPerPage:D,actions:$,className:"mt-4",currentPage:_,onPageChange:c,onItemsPerPageChange:e=>T(e)}):s.jsx(B,{nom:"maraîcher",search:d})})]})};export{Le as default};
