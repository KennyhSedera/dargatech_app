import{m as E,r as t,j as e,e as A}from"./app-C6Y3mXvi.js";import{C as M}from"./ConfirmDialog-CycUewLz.js";import{H as R}from"./HeaderPage-BnIYeHQh.js";import{u as $}from"./api-LtqWRRIP.js";import{T as G,I as D}from"./TextInput-Dz_PSUuv.js";import{I as F}from"./InputLabel-YQNDscCr.js";import{S as I}from"./Snackbar-DVuucd-d.js";import{I as H}from"./InputImage-Bf77NdDJ.js";import{e as O}from"./validateForm-CYV7VTEV.js";import{g as q,d as B}from"./TypePaiementService-DVMd1s1w.js";import{E as V}from"./EmptyState-CPLteZoP.js";import{G as z}from"./index-BDRFmiI1.js";import"./Modal-C5xX0yRe.js";import"./transition-ChBDwNje.js";import"./index-KKcqto2f.js";import"./constant-BhYKUVbl.js";import"./iconBase-B7rAnEeD.js";import"./index-CXRCyv1Q.js";const J=({reload:a=()=>{}})=>{const{data:o,setData:y,errors:b,reset:c}=E({name:"",logo_path:null}),[r,j]=t.useState({open:!1,message:"",type:"success"}),[m,l]=t.useState({}),v=t.useRef(null),[_,h]=t.useState("Ajouter"),[i,p]=t.useState(!1),d=async()=>{var w;if(!O(o,l))return;const n=new FormData;n.append("name",o.name),n.append("logo_path",o.logo_path),p(!0),h("Loading ...");try{const{data:g}=await A.post(`${$}/type_paiement`,n);j({open:!0,message:g.message,type:"success"})}catch(g){console.error("Erreur:",((w=g.response)==null?void 0:w.data)||g.message)}finally{u()}},N=n=>{y({...o,logo_path:n})},u=()=>{c(),h("Ajouter"),p(!1),l({}),a()};return e.jsxs("div",{className:"w-full p-4 mt-4 bg-white rounded-lg shadow-sm dark:bg-gray-800",children:[e.jsx(I,{message:r.message,type:r.type,duration:3e3,position:"top-right",show:r.open,onClose:()=>j({...r,message:"",open:!1})}),e.jsx("div",{className:"text-lg font-semibold text-center",children:"Nouveau"}),e.jsxs("form",{className:"grid w-full grid-cols-1 gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"type_name",value:"Nom"}),e.jsx(G,{id:"type_name",isFocused:!0,name:"type_name",value:o.name,className:"block w-full mt-1",autoComplete:"type_name",onChange:n=>y("name",n.target.value),required:!0,placeholder:"Nom de la type",onFocus:()=>l({...m,name:""})}),e.jsx(D,{message:m.name||b.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(F,{htmlFor:"logo_path",value:"Logo"}),e.jsx(H,{ref:v,selectedFile:o.logo_path,onLoadFile:N,onFocus:()=>l({...m,logo_path:""})}),e.jsx(D,{message:m.logo_path||b.logo_path,className:"mt-2"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("button",{className:"w-auto px-4 py-1 mr-2 text-red-600 rounded-md bg-red-400/20 disabled:cursor-not-allowed",onClick:u,children:"Annuler"}),e.jsx("button",{disabled:i,className:"w-auto px-4 py-1 text-white bg-blue-500 rounded-md disabled:cursor-not-allowed disabled:opacity-10 ",onClick:d,children:_})]})]})},K=({item:a,onDelete:o})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-white dark:border-gray-800 rounded-lg relative shadow-md",children:[e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx("button",{onClick:()=>o(a),className:"p-2 text-red-500 rounded-full bg-red-100 transition-colors",children:e.jsx(z,{className:"text-lg"})})}),e.jsx("div",{className:"h-40 w-full bg-gray-100 dark:bg-gray-900 rounded-t-lg overflow-hidden",children:a.logo_path?e.jsx("img",{src:a.logo_path,alt:`Logo ${a.name}`,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:"No Logo"})}),e.jsx("div",{className:"text-center p-4 font-semibold",children:a.name})]}),pe=()=>{const[a,o]=t.useState(""),[y,b]=t.useState({}),[c,r]=t.useState(1),[j,m]=t.useState([]),[l,v]=t.useState([]),[_,h]=t.useState(!0),[i,p]=t.useState({open:!1,message:"",id:0}),[d,N]=t.useState({open:!1,message:"",type:"success"}),u=async()=>{h(!0);try{const{type:s}=await q(),S=s.map(f=>({id:f.id,name:f.name,logo_path:f.logo_path}));m(S),v(S)}catch(s){console.log(s)}finally{h(!1)}};t.useEffect(()=>{u()},[]);const n=s=>{p({open:!0,message:`Êtes-vous sûr de vouloir supprimer la type de paiement par ${s.name} ?`,id:s.id})},w=async()=>{const{message:s}=await B(i.id);N({...d,message:s,open:!0}),p({...i,open:!1,id:0}),u(),r(1)},g=s=>{o(s),r(1);const S=j.filter(f=>f.name.toString().toLowerCase().includes(s.toLowerCase()));v(S)},C=8,P=c*C,T=P-C,L=l.slice(T,P),x=Math.ceil(l.length/C),k=()=>e.jsxs("div",{className:"flex justify-center mt-8",children:[e.jsx("button",{onClick:()=>r(s=>Math.max(s-1,1)),disabled:c===1,className:"px-4 py-2 mx-1 rounded-full border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Précédent"}),e.jsx("div",{className:"flex items-center mx-4",children:e.jsxs("span",{className:"text-gray-700",children:["Page ",c," sur ",x||1]})}),e.jsx("button",{onClick:()=>r(s=>Math.min(s+1,x)),disabled:c===x||x===0,className:"px-4 py-2 mx-1 rounded-full border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Suivant"})]});return e.jsxs("div",{children:[e.jsx(R,{search:a,onSearch:g,title:"Liste des types de paiement",btn:!1}),e.jsx(I,{message:d.message,type:d.type,duration:3e3,position:"top-right",show:d.open,onClose:()=>N({...d,message:"",open:!1})}),e.jsx(M,{open:i.open,message:i.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",close:()=>p({...i,open:!1}),accept:w}),_?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsx("div",{className:"sm:col-span-2",children:l.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mt-6",children:L.map(s=>e.jsx(K,{item:s,onDelete:n},s.id))}),x>1&&e.jsx(k,{})]}):e.jsx(V,{nom:"type de paiement",search:a})}),e.jsx("div",{className:"sm:col-span-1",children:e.jsx(J,{reload:()=>u(),dataToModify:y,setDataToModify:b})})]})]})};export{pe as default};
