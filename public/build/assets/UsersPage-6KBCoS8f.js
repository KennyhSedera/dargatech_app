import{j as e,r as i,L as F}from"./app-BQyrTZVC.js";import{A as E}from"./AuthenticatedLayout-BoTMMhs6.js";import{g as A,d as D}from"./userService-DQDw1Ykw.js";import{H as _}from"./HeaderPage-Durkh_Rg.js";import{S as P}from"./Snackbar-BVCqO3m-.js";import{C as z}from"./ConfirmDialog-DABb_ZE0.js";import{t as H,z as I,F as M,v as R,u as T}from"./constant-NEMinriC.js";import{E as V}from"./EmptyState-B9HpWti9.js";import"./transition-DyKxjau6.js";import"./iconBase-C8Uyol4w.js";import"./useTheme-CPOaTzb7.js";import"./index-Bva61L1C.js";import"./index-RbQYcc4a.js";import"./api-DNr_UqCX.js";import"./Modal-DxdL0X4M.js";import"./index-D2NUHNAS.js";const $=({user:t,handleDelete:u,handleImageError:p})=>{var c,x,g,d,h,o,l,r,n,m,f,j;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 dark:from-indigo-600 dark:via-purple-600 dark:to-blue-700 opacity-90"}),e.jsxs("div",{className:"relative pt-4 pb-14 px-6 flex justify-between items-start",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.name}),e.jsx("div",{className:"relative",children:t.user_role.name!=="admin"&&e.jsx("button",{onClick:()=>u(t.id),className:"p-2 text-white hover:bg-red-50 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(H,{})})})]}),e.jsx("div",{className:"absolute -bottom-12 left-6",children:e.jsx("div",{className:"h-24 w-24 rounded-xl shadow-md overflow-hidden border-4 border-white dark:border-gray-800",children:(c=t.profile)!=null&&c.photo||(x=t.technicien)!=null&&x.photo||(g=t.partenaire)!=null&&g.logo?e.jsx("img",{src:((d=t.profile)==null?void 0:d.photo)||((h=t.technicien)==null?void 0:h.photo)||((o=t.partenaire)==null?void 0:o.logo),alt:`${t.name}'s profile`,className:"h-full w-full object-cover bg-gray-100 dark:bg-gray-900",onError:p}):e.jsx("div",{className:"h-full w-full bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-700 dark:to-gray-600 flex items-center justify-center",children:e.jsx(I,{className:"text-4xl text-gray-400 dark:text-gray-300"})})})})]}),e.jsxs("div",{className:"pt-14 px-6 pb-6",children:[e.jsx("div",{className:"mt-2 mb-4",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-gradient-to-r from-green-400 to-blue-500 text-white",children:t.user_role.name})}),e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(M,{className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:t.email})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(R,{className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((l=t.technicien)==null?void 0:l.contact)||((r=t.profile)==null?void 0:r.contact)||((n=t.partenaire)==null?void 0:n.telephone)})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(T,{className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((m=t.technicien)==null?void 0:m.adress)||((f=t.profile)==null?void 0:f.adress)||((j=t.partenaire)==null?void 0:j.adresse)})]})]})]})]},t.id)},oe=()=>{const[t,u]=i.useState([]),[p,c]=i.useState([]),[x,g]=i.useState(!0),[d,h]=i.useState(""),[o,l]=i.useState({open:!1,message:"",id:0}),[r,n]=i.useState({open:!1,message:"",type:"success"}),m=async()=>{try{const s=await A();u(s),c(s)}catch(s){console.error("Failed to fetch users:",s)}finally{g(!1)}};i.useEffect(()=>{m()},[]);const f=s=>{h(s);const U=t.filter(a=>{var w,y,b,N,v,C,L;return a.name.toLowerCase().includes(s.toLowerCase())||a.email.toLowerCase().includes(s.toLowerCase())||((w=a.technicien)==null?void 0:w.contact.toLowerCase().includes(s.toLowerCase()))||((y=a.technicien)==null?void 0:y.adress.toLowerCase().includes(s.toLowerCase()))||a.user_role.name.toLowerCase().includes(s.toLowerCase())||((b=a.profile)==null?void 0:b.adress.toLowerCase().includes(s.toLowerCase()))||((N=a.profile)==null?void 0:N.contact.toLowerCase().includes(s.toLowerCase()))||((v=a.partenaire)==null?void 0:v.telephone.toLowerCase().includes(s.toLowerCase()))||((C=a.partenaire)==null?void 0:C.adresse.toLowerCase().includes(s.toLowerCase()))||((L=a.partenaire)==null?void 0:L.site_web.toLowerCase().includes(s.toLowerCase()))});c(U)},j=s=>{s.target.onerror=null,s.target.src="/path/to/default-avatar.png"},k=s=>{l({open:!0,message:"Voulez-vous vraiment supprimer cet utilisateur ?",id:s})},S=async()=>{const s=await D(o.id);s.success?(n({...r,open:!0,message:"Utilisateur supprimé avec succès",type:"success"}),l({...o,open:!1}),m()):n({...r,open:!0,message:s.message,type:"error"})};return e.jsxs(E,{children:[e.jsx(F,{title:"Users"}),e.jsx(_,{title:"Liste des utilisateurs",onSearch:f,search:d,btn:!1}),e.jsx(z,{open:o.open,message:o.message,btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white",accept:S,close:()=>l({...o,open:!1,id:0})}),e.jsx(P,{message:r.message,type:r.type,duration:3e3,position:"top-right",show:r.open,onClose:()=>n({...r,message:"",open:!1})}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:x?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):p.length===0?e.jsx(V,{nom:"utilisateur",search:d}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map(s=>e.jsx($,{user:s,handleDelete:k,handleImageError:j},s.id))})})})]})};export{oe as default};
