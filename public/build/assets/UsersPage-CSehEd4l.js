import{j as e,r as l,L as A}from"./app-BDvQqi8O.js";import{A as F}from"./AuthenticatedLayout-DCXVhSan.js";import{g as E,d as _}from"./userService-Bp4QfI3X.js";import{H as D}from"./HeaderPage-w1fcFvT7.js";import{S as P}from"./Snackbar-BRongGB3.js";import{C as H}from"./ConfirmDialog-KzKBN7n8.js";import{s as I,y as M,F as z,u as R,t as T}from"./constant-DTp0l4TC.js";import{E as V}from"./EmptyState-C14-jZH1.js";import"./transition-BzRYlxNR.js";import"./index-CC0TBsfS.js";import"./iconBase-Cmx0-DVi.js";import"./useTheme-D18_VcHq.js";import"./index-CfUTnf5Z.js";import"./api-B2KTsAU8.js";import"./Modal-DPvxb8TU.js";const $=({user:s,handleDelete:w,handleImageError:p})=>{var c,x,h,d,g,r,m,o,n,f,j,b;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 dark:from-indigo-600 dark:via-purple-600 dark:to-blue-700 opacity-90"}),e.jsxs("div",{className:"relative pt-4 pb-14 px-6 flex justify-between items-start",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:s.name}),e.jsx("div",{className:"relative",children:s.user_role.name!=="admin"&&e.jsx("button",{onClick:()=>w(s.id),className:"p-2 text-white hover:bg-red-50 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(I,{})})})]}),e.jsx("div",{className:"absolute -bottom-12 left-6",children:e.jsx("div",{className:"h-24 w-24 rounded-xl shadow-md overflow-hidden border-4 border-white dark:border-gray-800",children:(c=s.profile)!=null&&c.photo||(x=s.technicien)!=null&&x.photo||(h=s.partenaire)!=null&&h.logo?e.jsx("img",{src:((d=s.profile)==null?void 0:d.photo)||((g=s.technicien)==null?void 0:g.photo)||((r=s.partenaire)==null?void 0:r.logo),alt:`${s.name}'s profile`,className:"h-full w-full object-cover bg-gray-100 dark:bg-gray-900",onError:p}):e.jsx("div",{className:"h-full w-full bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-700 dark:to-gray-600 flex items-center justify-center",children:e.jsx(M,{className:"text-4xl text-gray-400 dark:text-gray-300"})})})})]}),e.jsxs("div",{className:"pt-14 px-6 pb-6",children:[e.jsx("div",{className:"mt-2 mb-4",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-gradient-to-r from-green-400 to-blue-500 text-white",children:s.user_role.name})}),e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(z,{className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:s.email})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(R,{className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((m=s.technicien)==null?void 0:m.contact)||((o=s.profile)==null?void 0:o.contact)||((n=s.partenaire)==null?void 0:n.telephone)})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(T,{className:"text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:((f=s.technicien)==null?void 0:f.adress)||((j=s.profile)==null?void 0:j.adress)||((b=s.partenaire)==null?void 0:b.adresse)})]})]})]})]},s.id)},re=()=>{const[s,w]=l.useState([]),[p,c]=l.useState([]),[x,h]=l.useState(!0),[d,g]=l.useState(""),[r,m]=l.useState({open:!1,message:"",btnAcceptName:"",title:"",btnAcceptColor:""}),[o,n]=l.useState({open:!1,message:"",type:"success"});l.useEffect(()=>{(async()=>{try{const i=await E();w(i),c(i)}catch(i){console.error("Failed to fetch users:",i)}finally{h(!1)}})()},[]);const f=t=>{g(t);const i=s.filter(a=>{var y,u,C,N,L,v,k,S,U;return a.name.toLowerCase().includes(t.toLowerCase())||a.email.toLowerCase().includes(t.toLowerCase())||((y=a.technicien)==null?void 0:y.contact.toLowerCase().includes(t.toLowerCase()))||((u=a.technicien)==null?void 0:u.adress.toLowerCase().includes(t.toLowerCase()))||a.user_role.name.toLowerCase().includes(t.toLowerCase())||((C=a.profile)==null?void 0:C.adress.toLowerCase().includes(t.toLowerCase()))||((N=a.profile)==null?void 0:N.contact.toLowerCase().includes(t.toLowerCase()))||((L=a.partenaire)==null?void 0:L.name.toLowerCase().includes(t.toLowerCase()))||((v=a.partenaire)==null?void 0:v.email.toLowerCase().includes(t.toLowerCase()))||((k=a.partenaire)==null?void 0:k.telephone.toLowerCase().includes(t.toLowerCase()))||((S=a.partenaire)==null?void 0:S.adress.toLowerCase().includes(t.toLowerCase()))||((U=a.partenaire)==null?void 0:U.site_web.toLowerCase().includes(t.toLowerCase()))});c(i)},j=t=>{t.target.onerror=null,t.target.src="/path/to/default-avatar.png"},b=t=>{m({open:!0,message:"Voulez-vous vraiment supprimer cet utilisateur ?",btnAcceptName:"Supprimer",title:"Suppression",btnAcceptColor:"bg-red-500 text-white"}),_(t).then(i=>{i.success?(n({...o,open:!0,message:"Utilisateur supprimé avec succès",type:"success"}),m({...r,open:!1}),fetchUsers()):n({...o,open:!0,message:i.message,type:"error"})})};return e.jsxs(F,{children:[e.jsx(A,{title:"Users"}),e.jsx(D,{title:"Liste des utilisateurs",onSearch:f,search:d,btn:!1}),e.jsx(H,{open:r.open,message:r.message,btnAcceptName:r.btnAcceptName,title:r.title,btnAcceptColor:r.btnAcceptColor,close:r.close,accept:r.accept}),e.jsx(P,{open:o.open,message:o.message,type:o.type,onClose:()=>n({...o,open:!1})}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:x?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):p.length===0?e.jsx(V,{nom:"utilisateur",search:d}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map(t=>e.jsx($,{user:t,handleDelete:b,handleImageError:j},t.id))})})})]})};export{re as default};
